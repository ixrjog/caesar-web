(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-002e0922"],{"04b5":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.formStatus.title,visible:t.formStatus.visible},on:{"update:visible":function(e){return t.$set(t.formStatus,"visible",e)}}},[a("el-form",{attrs:{model:t.tagTransfer}},[a("el-transfer",{attrs:{props:{key:"id",label:"tagKey"},data:t.tagTransfer.tagOptions,titles:["所有标签","当前标签"]},model:{value:t.tagTransfer.tagIds,callback:function(e){t.$set(t.tagTransfer,"tagIds",e)},expression:"tagTransfer.tagIds"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.formStatus.visible=!1}}},[t._v("关闭")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handlerSave}},[t._v("确定")])],1)],1)},i=[],r=a("a3e9"),s={data:function(){return{tagTransfer:{}}},name:"TagTransferDialog",props:["formStatus"],mixins:[],mounted:function(){},methods:{handleClick:function(){this.$emit("input",!this.value)},initData:function(t){this.tagTransfer=t},handlerSave:function(){var t=this;setTimeout((function(){Object(r["f"])(t.tagTransfer).then((function(e){t.$message({message:"成功",type:"success"}),t.formStatus.visible=!1,t.$emit("closeDialog")}))}),600)}}},o=s,u=a("2877"),l=function(t){t.options.__source="src/components/opscloud/dialog/TagTransferDialog.vue"},c=l,d=Object(u["a"])(o,n,i,!1,null,null,null);"function"===typeof c&&c(d);e["a"]=d.exports},7756:function(t,e,a){"use strict";var n=a("b40b"),i=a.n(n);i.a},"9b60":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("d2-container",[[a("div",[a("h1",[t._v(t._s(t.title))])]),a("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:24}},[a("el-select",{staticClass:"select",attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"搜索实例","remote-method":t.getInstance},model:{value:t.queryParam.instanceId,callback:function(e){t.$set(t.queryParam,"instanceId",e)},expression:"queryParam.instanceId"}},t._l(t.instanceOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-input",{staticClass:"input",attrs:{placeholder:"输入关键字模糊查询"},model:{value:t.queryParam.queryName,callback:function(e){t.$set(t.queryParam,"queryName",e)},expression:"queryParam.queryName"}}),a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:t.fetchData}},[t._v("查询")]),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{disabled:""===t.queryParam.instanceId},on:{click:t.handlerSync}},[t._v("同步")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"instance",label:"实例名称",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.instance.name))])]}}])}),a("el-table-column",{attrs:{prop:"name",label:"群组名称"}}),a("el-table-column",{attrs:{prop:"applicationKey",label:"绑定应用key"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{directives:[{name:"show",rawName:"v-show",value:null!==e.row.applicationKey,expression:"props.row.applicationKey !== null"}],attrs:{"disable-transitions":"",type:"primary",plain:"",size:"mini"}},[t._v(t._s(e.row.applicationKey))])]}}])}),a("el-table-column",{attrs:{prop:"groupVisibility",label:"访问",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{"disable-transitions":"",type:"primary",plain:"",size:"mini"}},[t._v(t._s(e.row.groupVisibility))])]}}])}),a("el-table-column",{attrs:{prop:"webUrl",label:"webUrl",width:"400"}}),a("el-table-column",{attrs:{prop:"description",label:"描述"}}),a("el-table-column",{attrs:{prop:"tags",label:"标签"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"tag-group"},t._l(e.row.tags,(function(e){return a("span",{key:e.id},[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:e.comment,placement:"top-start"}},[a("el-tag",{staticStyle:{"margin-left":"5px"},style:{color:e.color}},[t._v(t._s(e.tagKey))])],1)],1)})),0)]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return t.handlerRowTagEdit(e.row)}}},[t._v("标签")]),a("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(a){return t.handlerRowDel(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:t.pagination.total,"current-page":t.pagination.currentPage,"page-size":t.pagination.pageSize},on:{"current-change":t.paginationCurrentChange,"size-change":t.handleSizeChange}}),a("TagTransferDialog",{ref:"tagTransferDialog",attrs:{formStatus:t.formTagTransferStatus},on:{closeDialog:t.fetchData}})]],2)},i=[],r=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),s=a("5880"),o=a("04b5"),u=a("a3e9"),l=a("e68b"),c=a("9bd2"),d="/gitlab/group";function p(t){return Object(c["a"])({url:d+"/page/query",method:"post",data:t})}function f(t){return Object(c["a"])({url:d+"/del?id="+t,method:"delete"})}function g(t){return Object(c["a"])({url:d+"/sync?instanceId="+t,method:"get"})}function b(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?b(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var h={name:"GitlabGroupTable",data:function(){return{title:"Gitlab群组管理",tableData:[],options:{stripe:!0},loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{instanceId:"",queryName:""},instanceOptions:[],businessType:15,formTagTransferStatus:{visible:!1,title:"编辑服务器标签"}}},computed:m({},Object(s["mapState"])("d2admin/user",["info"])),mounted:function(){this.initPageSize(),this.fetchData(),this.getInstance()},components:{TagTransferDialog:o["a"]},methods:m({},Object(s["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(t){this.pagination.pageSize=t,this.info.pageSize=t,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},getInstance:function(t){var e=this,a={queryName:t,extend:0,page:1,length:10};Object(l["c"])(a).then((function(t){e.instanceOptions=t.body.data}))},handlerSync:function(){var t=this;g(this.queryParam.instanceId).then((function(e){t.$message({type:"success",message:"任务后台执行中!"})}))},handlerRowTagEdit:function(t){this.formTagTransferStatus.visible=!0;var e={businessId:t.id,businessType:this.businessType,tagIds:[],tagOptions:[]};Object(u["d"])("",1,100).then((function(t){e.tagOptions=t.body.data})),Object(u["c"])(this.businessType,e.businessId,"").then((function(t){for(var a in t.body)e.tagIds.push(t.body[a].id)})),this.formTagTransferStatus.visible=!0,this.$refs.tagTransferDialog.initData(e)},handlerRowDel:function(t){var e=this;this.$confirm("此操作将删除当前配置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){f(t.id).then((function(t){e.fetchData(),e.$message({type:"success",message:"删除成功!"})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},paginationCurrentChange:function(t){this.pagination.currentPage=t,this.fetchData()},fetchData:function(){var t=this;this.loading=!0;var e={instanceId:this.queryParam.instanceId,queryName:this.queryParam.queryName,extend:1,page:this.pagination.currentPage,length:this.pagination.pageSize};p(e).then((function(e){t.tableData=e.body.data,t.pagination.total=e.body.totalNum,t.loading=!1}))}})},y=h,v=(a("7756"),a("2877")),O=function(t){t.options.__source="src/pages/gitlab/group/index.vue"},S=O,w=Object(v["a"])(y,n,i,!1,null,null,null);"function"===typeof S&&S(w);e["default"]=w.exports},a3e9:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return s})),a.d(e,"e",(function(){return o})),a.d(e,"f",(function(){return u})),a.d(e,"c",(function(){return l}));var n=a("9bd2");function i(t,e,a){return Object(n["a"])({url:"/tag/page/query?tagKey="+t+"&page="+e+"&length="+a,method:"get"})}function r(t){return Object(n["a"])({url:"/tag/add",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/tag/del?id="+t,method:"delete"})}function o(t){return Object(n["a"])({url:"/tag/update",method:"put",data:t})}function u(t){return Object(n["a"])({url:"/tag/business/update",method:"put",data:t})}function l(t,e,a){return Object(n["a"])({url:"/tag/business/query?businessType="+t+"&businessId="+e+"&tagKey="+a,method:"get"})}},b40b:function(t,e,a){},e68b:function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return s})),a.d(e,"d",(function(){return o})),a.d(e,"b",(function(){return u}));var n=a("9bd2"),i="/gitlab/instance";function r(t){return Object(n["a"])({url:i+"/page/query",method:"post",data:t})}function s(t){return Object(n["a"])({url:i+"/add",method:"post",data:t})}function o(t){return Object(n["a"])({url:i+"/update",method:"put",data:t})}function u(t){return Object(n["a"])({url:i+"/del?id="+t,method:"delete"})}}}]);