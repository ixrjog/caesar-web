(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e0f436a"],{"21f3":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("d2-container",[[a("div",[a("h1",[t._v(t._s(t.title))])]),a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"实例",name:"instance"}},[a("gitlabInstanceTable")],1)],1)]],2)},i=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticStyle:{"margin-bottom":"5px","margin-left":"0px"},attrs:{gutter:24}},[a("el-input",{staticStyle:{display:"inline-block","max-width":"200px"},attrs:{placeholder:"输入关键字模糊查询"},model:{value:t.queryParam.queryName,callback:function(e){t.$set(t.queryParam,"queryName",e)},expression:"queryParam.queryName"}}),a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:t.fetchData}},[t._v("查询")]),a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:t.handlerAdd}},[t._v("新建")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"name",label:"实例名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))]),""!=e.row.version?a("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{"disable-transitions":"",type:"primary"}},[t._v(t._s(e.row.version.version)+" "+t._s(e.row.version.revision))]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"url",label:"管理url"}}),a("el-table-column",{attrs:{prop:"projectSize",label:"项目"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{"disable-transitions":"",type:"primary"}},[t._v(t._s(e.row.projectSize))])]}}])}),a("el-table-column",{attrs:{prop:"isActive",label:"有效"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{"disable-transitions":"",type:e.row.isActive?"success":"info"}},[t._v(t._s(e.row.isActive?"有效":"无效")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"comment",label:"描述"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"380"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return t.handlerRowEdit(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(a){return t.handlerRowDel(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:t.pagination.total,"current-page":t.pagination.currentPage,"page-size":t.pagination.pageSize},on:{"current-change":t.paginationCurrentChange,"size-change":t.handleSizeChange}}),a("GitlabInstanceDialog",{ref:"gitlabInstanceDialog",attrs:{formStatus:t.formStatus},on:{closeDialog:t.fetchData}})],1)},l=[],o=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),s=a("5880"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.formStatus.operationType?t.formStatus.addTitle:t.formStatus.updateTitle,visible:t.formStatus.visible},on:{"update:visible":function(e){return t.$set(t.formStatus,"visible",e)}}},[a("el-form",{attrs:{model:t.gitlabInstance}},[a("el-form-item",{attrs:{label:"实例名称","label-width":t.labelWidth,required:!0}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.gitlabInstance.name,callback:function(e){t.$set(t.gitlabInstance,"name",e)},expression:"gitlabInstance.name"}})],1),a("el-form-item",{attrs:{label:"gitlab服务器","label-width":t.labelWidth,required:!0}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"输入关键词搜索","remote-method":t.getServer,loading:t.serverLoading},model:{value:t.gitlabInstance.serverId,callback:function(e){t.$set(t.gitlabInstance,"serverId","string"===typeof e?e.trim():e)},expression:"gitlabInstance.serverId"}},t._l(t.serverOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}},[a("span",{staticStyle:{float:"left","margin-right":"15px"}},[t._v(t._s(e.name))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.privateIp))])])})),1)],1),a("el-form-item",{attrs:{label:"管理url","label-width":t.labelWidth,required:!0}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.gitlabInstance.url,callback:function(e){t.$set(t.gitlabInstance,"url",e)},expression:"gitlabInstance.url"}})],1),a("el-form-item",{attrs:{label:"token","label-width":t.labelWidth}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.gitlabInstance.token,callback:function(e){t.$set(t.gitlabInstance,"token",e)},expression:"gitlabInstance.token"}})],1),a("el-form-item",{attrs:{label:"有效","label-width":t.labelWidth,required:!0}},[a("el-select",{attrs:{clearable:""},model:{value:t.gitlabInstance.isActive,callback:function(e){t.$set(t.gitlabInstance,"isActive","string"===typeof e?e.trim():e)},expression:"gitlabInstance.isActive"}},t._l(t.activeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"描述","label-width":t.labelWidth}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.gitlabInstance.comment,callback:function(e){t.$set(t.gitlabInstance,"comment",e)},expression:"gitlabInstance.comment"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.formStatus.visible=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handlerSave}},[t._v("确定")])],1)],1)},u=[],d=a("b191"),p=a("e68b"),b=[{value:!0,label:"有效"},{value:!1,label:"无效"}],f={data:function(){return{gitlabInstance:{},labelWidth:"150px",options:{stripe:!0},activeOptions:b,serverLoading:!1,serverOptions:[]}},name:"GitlabInstanceDialog",props:["formStatus"],components:{},mounted:function(){},methods:{initData:function(t){this.gitlabInstance=t,""===this.gitlabInstance.id?this.getServer(""):(this.serverOptions=[],this.serverOptions.push(t.server))},handleClick:function(){this.$emit("input",!this.value)},getServer:function(t){var e=this;this.serverLoading=!0;var a={queryName:t,serverGroupId:"",envType:"",tagId:"",isActive:"",serverStatus:"",page:1,length:10};Object(d["c"])(a).then((function(t){e.serverOptions=t.body.data,e.serverLoading=!1}))},handlerSave:function(){var t=this;setTimeout((function(){var e=Object.assign({},t.gitlabInstance);t.formStatus.operationType?Object(p["a"])(e).then((function(e){t.$message({message:"成功",type:"success"}),t.formStatus.visible=!1,t.$emit("closeDialog")})):Object(p["d"])(e).then((function(e){t.$message({message:"成功",type:"success"}),t.formStatus.visible=!1,t.$emit("closeDialog")}))}),600)}}},m=f,g=a("2877"),v=function(t){t.options.__source="src/components/opscloud/gitlab/GitlabInstanceDialog.vue"},h=v,y=Object(g["a"])(m,c,u,!1,null,null,null);"function"===typeof h&&h(y);var S=y.exports;function O(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function I(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?O(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var _={name:"GitlabInstanceTable",data:function(){return{formStatus:{visible:!1,operationType:!0,addTitle:"新增Gitlab实例配置",updateTitle:"更新Gitlab实例配置"},tableData:[],options:{stripe:!0},loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{queryName:""}}},computed:I({},Object(s["mapState"])("d2admin/user",["info"])),mounted:function(){this.initPageSize(),this.fetchData()},components:{GitlabInstanceDialog:S},methods:I({},Object(s["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(t){this.pagination.pageSize=t,this.info.pageSize=t,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},handlerRowEdit:function(t){var e=Object.assign({},t);this.$refs.gitlabInstanceDialog.initData(e),this.formStatus.visible=!0,this.formStatus.operationType=!1},handlerRowDel:function(t){var e=this;this.$confirm("此操作将删除当前配置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(p["b"])(t.id).then((function(t){e.fetchData(),e.$message({type:"success",message:"删除成功!"})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handlerAdd:function(){var t={id:"",name:"",url:"",username:"",token:"",serverId:"",isActive:!0,comment:""};this.$refs.gitlabInstanceDialog.initData(t),this.formStatus.visible=!0,this.formStatus.operationType=!0},paginationCurrentChange:function(t){this.pagination.currentPage=t,this.fetchData()},fetchData:function(){var t=this;this.loading=!0;var e={queryName:this.queryParam.queryName,extend:1,page:this.pagination.currentPage,length:this.pagination.pageSize};Object(p["c"])(e).then((function(e){t.tableData=e.body.data,t.pagination.total=e.body.totalNum,t.loading=!1}))}})},w=_,j=(a("e80d"),function(t){t.options.__source="src/components/opscloud/gitlab/GitlabInstanceTable.vue"}),k=j,D=Object(g["a"])(w,r,l,!1,null,null,null);"function"===typeof k&&k(D);var x=D.exports,z={data:function(){return{title:"Gitlab实例管理",activeName:"instance"}},computed:{},mounted:function(){},components:{GitlabInstanceTable:x},methods:{}},P=z,$=function(t){t.options.__source="src/pages/gitlab/instance/index.vue"},q=$,T=Object(g["a"])(P,n,i,!1,null,null,null);"function"===typeof q&&q(T);e["default"]=T.exports},b191:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"f",(function(){return l})),a.d(e,"b",(function(){return o})),a.d(e,"d",(function(){return s})),a.d(e,"e",(function(){return c}));var n=a("9bd2");function i(t){return Object(n["a"])({url:"/server/page/fuzzy/query",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/server/add",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/server/update",method:"put",data:t})}function o(t){return Object(n["a"])({url:"/server/del?id="+t,method:"delete"})}function s(t){return Object(n["a"])({url:"/server/attribute/query?id="+t,method:"get"})}function c(t){return Object(n["a"])({url:"/server/attribute/save",method:"put",data:t})}},e68b:function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return l})),a.d(e,"d",(function(){return o})),a.d(e,"b",(function(){return s}));var n=a("9bd2"),i="/gitlab/instance";function r(t){return Object(n["a"])({url:i+"/page/query",method:"post",data:t})}function l(t){return Object(n["a"])({url:i+"/add",method:"post",data:t})}function o(t){return Object(n["a"])({url:i+"/update",method:"put",data:t})}function s(t){return Object(n["a"])({url:i+"/del?id="+t,method:"delete"})}},e80d:function(t,e,a){"use strict";var n=a("fcae"),i=a.n(n);i.a},fcae:function(t,e,a){}}]);