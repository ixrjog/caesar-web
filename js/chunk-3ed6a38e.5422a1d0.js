(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ed6a38e"],{5035:function(e,t,a){"use strict";var o=a("5c4b"),n=a.n(o);n.a},"5c4b":function(e,t,a){},b0d0:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("h1",[e._v(e._s(e.title))]),a("KeyboxTable",{ref:"keyboxTable"})],1)},n=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:24}},[a("el-input",{staticClass:"input-bar",attrs:{placeholder:"系统账户查询"},model:{value:e.queryParam.queryName,callback:function(t){e.$set(e.queryParam,"queryName",t)},expression:"queryParam.queryName"}}),a("el-button",{staticClass:"button",on:{click:e.fetchData}},[e._v("查询")]),a("el-button",{staticClass:"button",on:{click:e.addItem}},[e._v("新增")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{prop:"systemUser",label:"系统账户"}}),a("el-table-column",{attrs:{prop:"keyType",label:"密钥类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:0===t.row.keyType?"success":"info"}},[e._v(" "+e._s(0===t.row.keyType?"sshKey":"password")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"fingerprint",label:"指纹"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(a){return e.delItem(t.row)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize},on:{"current-change":e.paginationCurrentChange,"size-change":e.handleSizeChange}}),a("KeyboxDialog",{ref:"keyboxDialog",attrs:{formStatus:e.formStatus},on:{closeKeyboxDialog:e.fetchData}})],1)},i=[],s=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),r=a("5880"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增全局密钥配置",visible:e.formStatus.visible,"before-close":e.closeDialog},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)}}},[a("el-form",{attrs:{model:e.keyboxData}},[a("el-form-item",{attrs:{label:"标题","label-width":e.labelWidth}},[a("el-input",{model:{value:e.keyboxData.title,callback:function(t){e.$set(e.keyboxData,"title",t)},expression:"keyboxData.title"}})],1)],1),a("el-form",{attrs:{model:e.keyboxData}},[a("el-form-item",{attrs:{label:"系统账户","label-width":e.labelWidth}},[a("el-input",{model:{value:e.keyboxData.systemUser,callback:function(t){e.$set(e.keyboxData,"systemUser",t)},expression:"keyboxData.systemUser"}})],1)],1),a("el-form",{attrs:{model:e.keyboxData}},[a("el-form-item",{attrs:{label:"密钥类型","label-width":e.labelWidth}},[a("el-select",{attrs:{placeholder:"密钥类型"},model:{value:e.keyboxData.keyType,callback:function(t){e.$set(e.keyboxData,"keyType",t)},expression:"keyboxData.keyType"}},e._l(e.keyTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-form",{attrs:{model:e.keyboxData}},[a("el-form-item",{attrs:{label:"首选密钥","label-width":e.labelWidth}},[a("el-select",{attrs:{placeholder:"首选密钥"},model:{value:e.keyboxData.defaultKey,callback:function(t){e.$set(e.keyboxData,"defaultKey",t)},expression:"keyboxData.defaultKey"}},e._l(e.defaultKeyOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.keyboxData.keyType,expression:"keyboxData.keyType === 0"}],attrs:{model:e.keyboxData}},[a("el-form-item",{attrs:{label:"公钥","label-width":e.labelWidth,required:!0}},[a("el-input",{model:{value:e.keyboxData.publicKey,callback:function(t){e.$set(e.keyboxData,"publicKey",t)},expression:"keyboxData.publicKey"}})],1)],1),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0===e.keyboxData.keyType,expression:"keyboxData.keyType === 0"}],attrs:{model:e.keyboxData}},[a("el-form-item",{attrs:{label:"私钥","label-width":e.labelWidth,required:!0}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:16},clearable:"",placeholder:"请输入内容"},model:{value:e.keyboxData.privateKey,callback:function(t){e.$set(e.keyboxData,"privateKey",t)},expression:"keyboxData.privateKey"}})],1)],1),a("el-form",{attrs:{model:e.keyboxData}},[a("el-form-item",{attrs:{label:"密码","label-width":e.labelWidth}},[a("el-input",{model:{value:e.keyboxData.passphrase,callback:function(t){e.$set(e.keyboxData,"passphrase",t)},expression:"keyboxData.passphrase"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeDialog}},[e._v("关闭")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveInfo}},[e._v("保存")])],1)],1)},c=[],b=a("9bd2");function p(e){return Object(b["a"])({url:"/keybox/page/query",method:"post",data:e})}function y(e){return Object(b["a"])({url:"/keybox/add",method:"post",data:e})}function f(e){return Object(b["a"])({url:"/keybox/del?id="+e,method:"delete"})}var d={data:function(){return{keyboxData:{},labelWidth:"100px",keyTypeOptions:[{value:0,label:"SSH密钥对"},{value:1,label:"密码"}],defaultKeyOptions:[{value:0,label:"非首选密钥"},{value:1,label:"是首选密钥"}]}},name:"KeyboxDialog",props:["formStatus"],mixins:[],mounted:function(){},mutation:function(){},methods:{initData:function(){this.keyboxData={id:"",systemUser:"",title:"",publicKey:"",privateKey:"",passphrase:"",keyType:0,defaultKey:0}},closeDialog:function(){this.formStatus.visible=!1,this.$emit("closeKeyboxDialog")},saveInfo:function(){var e=this;setTimeout((function(){y(e.keyboxData).then((function(t){t.success?(e.$message({message:"成功",type:"success"}),e.sshPubKey=t.body):e.$message.error("错误:"+t.msg)}))}),30)}}},m=d,h=a("2877"),g=function(e){e.options.__source="src/components/opscloud/keybox/KeyboxDialog.vue"},k=g,x=Object(h["a"])(m,u,c,!1,null,null,null);"function"===typeof k&&k(x);var v=x.exports;function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S={data:function(){return{formStatus:{visible:!1},tableData:[],loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{queryName:""}}},name:"KeyboxTable",props:[],mounted:function(){this.initPageSize()},computed:w({},Object(r["mapState"])("d2admin/user",["info"])),components:{KeyboxDialog:v},methods:w({},Object(r["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(e){this.pagination.pageSize=e,this.info.pageSize=e,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},addItem:function(){this.formStatus.visible=!0,this.$refs.keyboxDialog.initData()},delItem:function(e){var t=this;this.$confirm("此操作将删除当前配置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){f(e.id).then((function(e){t.fetchData(),t.$message({type:"success",message:"删除成功!"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.loading=!0;var t={querySystemUser:this.queryParam.queryName,page:this.pagination.currentPage,length:this.pagination.pageSize};p(t).then((function(t){e.tableData=t.body.data,e.pagination.total=t.body.totalNum,e.loading=!1}))}})},O=S,K=(a("5035"),function(e){e.options.__source="src/components/opscloud/keybox/KeyboxTable.vue"}),_=K,P=Object(h["a"])(O,l,i,!1,null,"d571fa0a",null);"function"===typeof _&&_(P);var T=P.exports,j={data:function(){return{title:"全局密钥管理"}},components:{KeyboxTable:T},mounted:function(){this.$refs.keyboxTable.fetchData()},methods:{}},z=j,$=function(e){e.options.__source="src/pages/setting/keybox/index.vue"},q=$,C=Object(h["a"])(z,o,n,!1,null,null,null);"function"===typeof q&&q(C);t["default"]=C.exports}}]);