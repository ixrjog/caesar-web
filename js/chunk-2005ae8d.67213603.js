(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2005ae8d"],{"01f6":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("d2-container",[[n("div",[n("h1",[e._v("用户角色配置")])]),n("div",{staticStyle:{"margin-bottom":"5px"}},[n("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:24}},[n("el-input",{staticClass:"input-search-bar",attrs:{placeholder:"用户名"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}}),n("el-select",{staticClass:"search-bar",attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"输入关键词搜索角色","remote-method":e.getRole,loading:e.loading},model:{value:e.queryParam.roleId,callback:function(t){e.$set(e.queryParam,"roleId",t)},expression:"queryParam.roleId"}},e._l(e.roleOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1),n("el-button",{staticClass:"search-bar",on:{click:e.fetchData}},[e._v("查询")]),n("el-button",{staticClass:"search-bar",on:{click:e.addItem}},[e._v("新增")]),n("el-button",{staticClass:"search-bar",on:{click:e.handlerSyncUserRole}},[e._v("同步")])],1)],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{prop:"username",label:"用户名"}}),n("el-table-column",{attrs:{prop:"displayName",label:"显示名"}}),n("el-table-column",{attrs:{prop:"roleName",label:"角色"}}),n("el-table-column",{attrs:{prop:"roleComment",label:"描述"}}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(n){return e.delItem(t.row)}}},[e._v("删除")])]}}])})],1),n("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize},on:{"current-change":e.paginationCurrentChange,"size-change":e.handleSizeChange}}),n("UserRoleDialog",{attrs:{formStatus:e.formUserRoleStatus,formData:e.userRole},on:{closeUserRoleDialog:e.fetchData}})]],2)},r=[],o=(n("a4d3"),n("4de4"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("ade3")),i=n("5880"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.formStatus.title,visible:e.formStatus.visible},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)}}},[n("el-form",{attrs:{model:e.formData}},[n("el-form-item",{attrs:{label:"用户","label-width":e.formStatus.labelWidth}},[n("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"输入关键词搜索用户","remote-method":e.getUser,loading:e.loading},model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}},e._l(e.userOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.username,value:e.username}})})),1)],1)],1),n("el-form",{attrs:{model:e.formData}},[n("el-form-item",{attrs:{label:"角色","label-width":e.formStatus.labelWidth}},[n("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"输入关键词搜索角色","remote-method":e.getRole,loading:e.loading},model:{value:e.formData.roleId,callback:function(t){e.$set(e.formData,"roleId",t)},expression:"formData.roleId"}},e._l(e.roleOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.formStatus.visible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.saveInfo}},[e._v("确定")])],1)],1)},l=[],s=n("4175"),c=n("2d8e"),d=n("9bd2");function f(e,t,n,a){return Object(d["a"])({url:"/auth/user/role/page/query?username="+e+"&roleId="+t+"&page="+n+"&length="+a,method:"get"})}function m(e){return Object(d["a"])({url:"/auth/user/role/add",method:"post",data:e})}function p(){return Object(d["a"])({url:"/auth/user/role/sync",method:"get"})}function h(e){return Object(d["a"])({url:"/auth/user/role/del?id="+e,method:"delete"})}var b={data:function(){return{loading:!1,userOptions:[],roleOptions:[]}},name:"user-dialog",props:["formStatus","formData"],mounted:function(){this.getRole(""),this.getUser("")},methods:{getRole:function(e){var t=this;Object(s["c"])(e,"",1,10).then((function(e){t.roleOptions=e.body.data}))},getUser:function(e){var t=this;Object(c["h"])(e,"",1,20).then((function(e){t.userOptions=e.body.data}))},handleClick:function(){this.$emit("input",!this.value)},saveInfo:function(){var e=this;setTimeout((function(){var t=Object.assign({},e.formData);m(t).then((function(t){e.$message({message:"成功",type:"success"}),e.formStatus.visible=!1,e.$emit("closeUserRoleDialog")}))}),600)}}},g=b,y=n("2877"),v=function(e){e.options.__source="src/components/opscloud/dialog/UserRoleDialog.vue"},O=v,j=Object(y["a"])(g,u,l,!1,null,null,null);"function"===typeof O&&O(j);var S=j.exports;function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={data:function(){return{userRole:{},formUserRoleStatus:{visible:!1,title:"用户角色绑定配置",labelWidth:"100px"},tableData:[],loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{roleId:"",username:""},userOptions:[],roleOptions:[]}},computed:k({},Object(i["mapState"])("d2admin/user",["info"])),mounted:function(){this.initPageSize(),this.fetchData()},components:{UserRoleDialog:S},methods:k({},Object(i["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(e){this.pagination.pageSize=e,this.info.pageSize=e,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},getRole:function(e){var t=this;Object(s["c"])(e,"",1,10).then((function(e){t.roleOptions=e.body.data}))},getUser:function(e){var t=this;Object(c["h"])(e,"",1,20).then((function(e){t.userOptions=e.body.data}))},handleClick:function(){this.$emit("input",!this.value)},handleDialogCancel:function(e){this.$message({message:"取消保存",type:"warning"}),e()},delItem:function(e){var t=this;this.$confirm("此操作将删除当前配置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){h(e.id).then((function(e){t.fetchData(),t.$message({type:"success",message:"删除成功!"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},addItem:function(){this.formUserRoleStatus.visible=!0,this.userRole={id:"",username:"",roleId:""}},handlerSyncUserRole:function(){var e=this;p().then((function(t){e.$message({type:"success",message:"后台同步中"})}))},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.loading=!0,f(this.queryParam.username,this.queryParam.roleId,this.pagination.currentPage,this.pagination.pageSize).then((function(t){e.tableData=t.body.data,e.pagination.total=t.body.totalNum,e.loading=!1}))}})},w=P,z=(n("dda4"),function(e){e.options.__source="src/pages/auth/user-role/index.vue"}),_=z,R=Object(y["a"])(w,a,r,!1,null,"1acb7c8e",null);"function"===typeof _&&_(R);t["default"]=R.exports},"2d8e":function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"j",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"l",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"k",(function(){return h})),n.d(t,"i",(function(){return b}));var a=n("9bd2");function r(e,t,n,r){return Object(a["a"])({url:"/user/page/query?username="+e+"&extend="+t+"&page="+n+"&length="+r,method:"get"})}function o(){return Object(a["a"])({url:"/user/detail",method:"get"})}function i(e){return Object(a["a"])({url:"/user/page/fuzzy/query",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/user/create",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/user/update",method:"put",data:e})}function s(e){return Object(a["a"])({url:"/user/retire?id="+e,method:"put"})}function c(e){return Object(a["a"])({url:"/user/del?id="+e,method:"delete"})}function d(){return Object(a["a"])({url:"/user/password/random",method:"get"})}function f(){return Object(a["a"])({url:"/user/ldap/sync",method:"get"})}function m(e){return Object(a["a"])({url:"/user/token/apply",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/user/token/del?id="+e,method:"delete"})}function h(e){return Object(a["a"])({url:"/user/credential/save",method:"post",data:e})}function b(e){return Object(a["a"])({url:"/user/server/tree/query",method:"post",data:e})}},4175:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return u}));var a=n("9bd2");function r(e,t,n,r){return Object(a["a"])({url:"/auth/role/page/query?roleName="+e+"&resourceName="+t+"&page="+n+"&length="+r,method:"get"})}function o(e){return Object(a["a"])({url:"/auth/role/add",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/auth/role/del?id="+e,method:"delete"})}function u(e){return Object(a["a"])({url:"/auth/role/update",method:"put",data:e})}},d121:function(e,t,n){},dda4:function(e,t,n){"use strict";var a=n("d121"),r=n.n(a);r.a}}]);