(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d67c0"],{"736d":function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("d2-container",[[r("div",[r("h1",[t._v("Script执行")])]),r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:8}},[r("ServerTree",{ref:"serverTree"})],1),r("el-col",{attrs:{span:16}},[r("el-select",{style:t.searchBarStyle,attrs:{filterable:"","value-key":"id","reserve-keyword":"",remote:"",placeholder:"搜索script","remote-method":t.getScript,loading:t.scriptSearching},on:{change:t.selectScript},model:{value:t.script,callback:function(e){t.script="string"===typeof e?e.trim():e},expression:"script"}},t._l(t.scriptOptions,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),1),r("el-tooltip",{attrs:{content:"预览script脚本",placement:"bottom",effect:"light"}},[r("el-button",{style:t.searchBarStyle,on:{click:t.previewContent}},[t._v("预览")])],1),r("el-tooltip",{attrs:{content:"批量命令执行",placement:"bottom",effect:"light"}},[r("el-button",{style:t.searchBarStyle,on:{click:t.executorScript}},[t._v("执行")])],1),r("el-form",{attrs:{model:t.executorScriptParam}},[r("el-form-item",{staticStyle:{"max-width":"400px","margin-top":"5px"},attrs:{label:"并发线程数","label-width":t.labelWidth,required:!0}},[r("el-slider",{attrs:{min:2,max:10,step:2,"show-stops":""},model:{value:t.executorScriptParam.concurrent,callback:function(e){t.$set(t.executorScriptParam,"concurrent",e)},expression:"executorScriptParam.concurrent"}})],1),r("el-form-item",{staticStyle:{"max-width":"400px","margin-top":"5px"},attrs:{label:"script参数","label-width":t.labelWidth}},[r("editor",{attrs:{lang:"sh",theme:"chrome",width:"800",height:"80",options:t.options},on:{init:t.editorInit},model:{value:t.executorScriptParam.scriptParam,callback:function(e){t.$set(t.executorScriptParam,"scriptParam",e)},expression:"executorScriptParam.scriptParam"}})],1)],1),r("AnsibleResult",{ref:"ansibleResult"})],1)],1),r("PreviewContentDialog",{ref:"previewDialog",attrs:{formStatus:t.formPreviewStatus}})]],2)},s=[],c=(r("b0c0"),r("c8c3")),a=r("ae11"),n=r("ebec"),o=r("67ee"),l={data:function(){return{serverTask:"",taskId:"",searchBarHeadStyle:{display:"inline-block",maxWidth:"200px"},searchBarStyle:{marginLeft:"5px"},uuid:"",options:{stripe:!0},executorScriptParam:{scriptId:"",scriptParam:"",concurrent:4,becomeUser:"",hostPatterns:[],uuid:"",taskType:1},scriptSearching:!1,script:{},scriptOptions:[],labelWidth:"100px",formPreviewStatus:{visible:!1,labelWidth:"100px"}}},mounted:function(){this.getScript("")},components:{ServerTree:c["a"],PreviewContentDialog:a["a"],AnsibleResult:n["a"],editor:r("7c9e")},methods:{selectScript:function(t){this.script=t||{}},getScript:function(t){var e=this;this.scriptSearching=!0;var r={queryName:t,page:1,length:20};Object(o["n"])(r).then((function(t){e.scriptOptions=t.body.data,e.scriptSearching=!1}))},previewContent:function(){var t={name:this.script.name,content:this.script.scriptContent,path:this.script.path,lang:this.script.scriptLang,comment:this.script.comment};this.formPreviewStatus.visible=!0,this.$refs.previewDialog.initData(t)},editorInit:function(){r("2099"),r("2968"),r("446e"),r("95b8"),r("ec5e")},executorScript:function(){var t=this,e=Object.assign({},this.executorScriptParam);try{if(e.hostPatterns=this.$refs.serverTree.getCheckedKeys(!0),e.uuid=this.$refs.serverTree.getUuid(),"[]"===JSON.stringify(e.hostPatterns))return void this.$message.error("未选择服务器节点")}catch(r){return void this.$message.error("服务器节点查询失败")}"{}"!==JSON.stringify(this.script)?(e.scriptId=this.script.id,Object(o["j"])(e).then((function(e){e.success?(t.$message({message:"任务执行中!",type:"success"}),t.$refs.ansibleResult.initData(e.body.id)):t.$message.error(e.msg)}))):this.$message.error("未选择script")}}},p=l,u=r("2877"),h=function(t){t.options.__source="src/pages/task/script/index.vue"},m=h,d=Object(u["a"])(p,i,s,!1,null,null,null);"function"===typeof m&&m(d);e["default"]=d.exports}}]);