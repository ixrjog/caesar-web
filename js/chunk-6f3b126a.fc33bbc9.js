(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f3b126a"],{"0462":function(e,t,r){"use strict";var a=r("634f"),n=r.n(a);n.a},"04b5":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.formStatus.title,visible:e.formStatus.visible},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)}}},[r("el-form",{attrs:{model:e.tagTransfer}},[r("el-transfer",{attrs:{props:{key:"id",label:"tagKey"},data:e.tagTransfer.tagOptions,titles:["所有标签","当前标签"]},model:{value:e.tagTransfer.tagIds,callback:function(t){e.$set(e.tagTransfer,"tagIds",t)},expression:"tagTransfer.tagIds"}})],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini"},on:{click:function(t){e.formStatus.visible=!1}}},[e._v("关闭")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handlerSave}},[e._v("确定")])],1)],1)},n=[],s=r("a3e9"),i={data:function(){return{tagTransfer:{}}},name:"TagTransferDialog",props:["formStatus"],mixins:[],mounted:function(){},methods:{handleClick:function(){this.$emit("input",!this.value)},initData:function(e){this.tagTransfer=e},handlerSave:function(){var e=this;setTimeout((function(){Object(s["f"])(e.tagTransfer).then((function(t){e.$message({message:"成功",type:"success"}),e.formStatus.visible=!1,e.$emit("closeDialog")}))}),600)}}},o=i,l=r("2877"),u=function(e){e.options.__source="src/components/opscloud/dialog/TagTransferDialog.vue"},c=u,d=Object(l["a"])(o,a,n,!1,null,null,null);"function"===typeof c&&c(d);t["a"]=d.exports},"0ef1":function(e,t,r){},"604d":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return i}));var a=r("9bd2");function n(e){return Object(a["a"])({url:"/setting/query?name="+e,method:"get"})}function s(){return Object(a["a"])({url:"/setting/all/query",method:"get"})}function i(e){return Object(a["a"])({url:"/setting/update",method:"put",data:e})}},"634f":function(e,t,r){},"95ff":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.title,visible:e.formStatus.visible,width:"80%","before-close":e.handlerCloseDialog},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)}}},[e._l(e.xterms,(function(t){return r("div",{key:t},[[r("el-col",{attrs:{span:24}},[r("el-card",{staticStyle:{"margin-right":"10px","margin-bottom":"10px"},attrs:{shadow:"hover","body-style":"padding: 2px"}},[r("div",{staticClass:"clearfix",staticStyle:{height:"15px"},attrs:{slot:"header"},slot:"header"},[r("span",[r("el-tag",[e._v(" "+e._s(t))])],1),r("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"退出",placement:"top-start"}},[r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(r){return e.handlerLogout(t)}}},[e._v(" Logout ")])],1),r("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"复制会话",placement:"top-start"}},[r("el-button",{staticStyle:{float:"right",padding:"3px 0","margin-right":"20px"},attrs:{type:"text"},on:{click:function(t){return e.handlerDuplicateSession()}}},[e._v("Duplicate ")])],1)],1),r("div",{staticClass:"xterm",attrs:{id:t}})])],1)]],2)})),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini"},on:{click:e.handlerExit}},[e._v("关闭")])],1)],2)},n=[],s=(r("4de4"),r("d81d"),r("b0c0"),r("1276"),r("c276")),i=(r("abb2"),r("fcf3")),o=r("47d0"),l=r("e232"),u="ws/xterm",c="XTERM",d={data:function(){return{title:"Web-XTerminal",socketURI:s["a"].wsUrl(u),server:{},addonMap:[],xterms:[],xtermMap:{},timer:null,xtermSize:{rows:30},xtermTheme:{foreground:"#FFFFFF",background:"#606266",cursor:"help"}}},name:"XTerm",props:["formStatus"],mixins:[],mounted:function(){this.setXTermSetting()},beforeDestroy:function(){try{for(var e in this.socket.close(),this.xtermMap)this.xtermMap[e].dispose()}catch(t){}clearInterval(this.timer)},methods:{setXTermSetting:function(){var e=this;Object(l["a"])(c).then((function(t){if(t.success)try{e.xtermTheme.foreground=t.body["XTERM_FOREGROUND"],e.xtermTheme.background=t.body["XTERM_BACKGROUND"],e.xtermSize.rows=t.body["XTERM_ROWS"]||30}catch(r){}else e.$message.error(t.msg)}))},handlerExit:function(){this.handlerClose();try{for(var e in this.socket.close(),this.xtermMap)this.xtermMap[e].dispose()}catch(t){}this.formStatus.visible=!1},initData:function(e){this.server=e,this.handlerLogin()},setTimer:function(){var e=this;this.timer=setInterval((function(){e.handlerSSHHeartbeat()}),1e4)},handlerSSHHeartbeat:function(){var e={status:"HEARTBEAT"};try{this.socketOnSend(JSON.stringify(e))}catch(t){}},initTermInstance:function(e){var t=this,r=e.name,a=new i["Terminal"]({rendererType:"canvas",allowTransparency:!0,fontSize:11,rows:this.xtermSize.rows,theme:this.xtermTheme,termName:"xterm",visualBell:!1,popOnBell:!1,scrollback:1e3,screenKeys:!1,debug:!1,cancelEvents:!1,cursorStyle:"underline",cursorBlink:!0,convertEol:!0});t.addonMap[r]=new o["FitAddon"],a.loadAddon(t.addonMap[r]),a.open(document.getElementById(r)),t.addonMap[r].fit(),a.focus(),a.onData((function(e){var a={data:e,status:"COMMAND",instanceId:r};t.socketOnSend(JSON.stringify(a))})),this.xtermMap[r]=a},handlerResize:function(){for(var e in this.xtermMap){this.addonMap[e].fit();var t={status:"RESIZE",instanceId:e,xtermWidth:7*this.addonMap[e]._terminal.cols,xtermHeight:document.getElementById(e).clientHeight};this.socketOnSend(JSON.stringify(t)),this.xtermMap[e].scrollToBottom()}},handlerDuplicateSession:function(){var e=this,t=this.server.name+"#"+s["a"].uuid(),r={status:"DUPLICATE_SESSION_IP",duplicateInstanceId:this.server.name,token:s["a"].cookies.get("token"),instanceId:t,xtermWidth:7*this.addonMap[t.split("#")[0]]._terminal.cols,xtermHeight:document.getElementById(t.split("#")[0]).clientHeight};this.xterms.push(t);var a={name:t,ip:this.server.privateIp};this.$nextTick((function(){e.initTermInstance(a),e.socketOnSend(JSON.stringify(r))}))},handlerLogout:function(e){var t={status:"LOGOUT",instanceId:e};this.socketOnSend(JSON.stringify(t));var r=this.xtermMap[e];r.dispose(),delete this.xtermMap[e],this.xterms=this.xterms.filter((function(t){return t!==e})),this.$message.warning(e+"终端已关闭")},handlerClose:function(){var e={status:"CLOSE"};this.socketOnSend(JSON.stringify(e)),this.xterms=[],this.xtermMap={},clearInterval(this.timer)},handlerCloseDialog:function(e){var t=this;this.$confirm("确定退出Web终端,并关闭所有会话?").then((function(r){e(),t.handlerExit()})).catch((function(e){}))},handlerLogin:function(){this.xtermMap={},this.initSocket(),this.setTimer()},initSocket:function(){this.socket=new WebSocket(this.socketURI),this.socketOnClose(),this.socketOnOpen(),this.socketOnError(),this.socketOnMessage()},socketOnOpen:function(){var e=this;this.socket.onopen=function(){try{e.xterms=[],e.xterms.push(e.server.name),e.$nextTick((function(){e.initTermInstance(e.server);var t={token:s["a"].cookies.get("token"),instanceId:e.server.name,ip:e.server.privateIp,status:"INITIAL_IP",xtermWidth:0,xtermHeight:308};e.socketOnSend(JSON.stringify(t)),e.$nextTick((function(){e.handlerResize()}))}))}catch(t){e.$message.error("登录失败，未选择服务器或其它原因")}}},socketOnClose:function(){this.socket.onclose=function(){}},socketOnError:function(){this.socket.onerror=function(){}},socketOnSend:function(e){this.socket.send(e)},socketOnMessage:function(){var e=this;this.socket.onmessage=function(t){var r=JSON.parse(t.data),a=e;r.map((function(e){a.xtermMap[e.instanceId].write(e.output)}))}}}},p=d,f=(r("0462"),r("2877")),m=function(e){e.options.__source="src/components/opscloud/xterm/XTerm.vue"},v=m,g=Object(f["a"])(p,a,n,!1,null,null,null);"function"===typeof v&&v(g);t["a"]=g.exports},"9ce0":function(e,t,r){"use strict";var a=r("0ef1"),n=r.n(a);n.a},a3e9:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return l})),r.d(t,"c",(function(){return u}));var a=r("9bd2");function n(e,t,r){return Object(a["a"])({url:"/tag/page/query?tagKey="+e+"&page="+t+"&length="+r,method:"get"})}function s(e){return Object(a["a"])({url:"/tag/add",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/tag/del?id="+e,method:"delete"})}function o(e){return Object(a["a"])({url:"/tag/update",method:"put",data:e})}function l(e){return Object(a["a"])({url:"/tag/business/update",method:"put",data:e})}function u(e,t,r){return Object(a["a"])({url:"/tag/business/query?businessType="+e+"&businessId="+t+"&tagKey="+r,method:"get"})}},ade6:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("d2-container",[[r("div",[r("h1",[e._v(e._s(e.title))])]),r("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:24}},[r("el-input",{staticClass:"input-bar",attrs:{placeholder:"输入关键字查询"},model:{value:e.queryParam.queryName,callback:function(t){e.$set(e.queryParam,"queryName","string"===typeof t?t.trim():t)},expression:"queryParam.queryName"}}),r("el-select",{staticClass:"select-bar",attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"搜索服务器组","remote-method":e.getServerGroup,loading:e.loading},model:{value:e.queryParam.serverGroupId,callback:function(t){e.$set(e.queryParam,"serverGroupId","string"===typeof t?t.trim():t)},expression:"queryParam.serverGroupId"}},e._l(e.serverGroupOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),r("el-select",{staticClass:"select-bar",attrs:{clearable:"",placeholder:"环境"},model:{value:e.queryParam.envType,callback:function(t){e.$set(e.queryParam,"envType",t)},expression:"queryParam.envType"}},e._l(e.envTypeOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.envName,value:e.envType}})})),1),r("el-select",{staticClass:"select-bar",attrs:{clearable:"",placeholder:"有效"},model:{value:e.queryParam.isActive,callback:function(t){e.$set(e.queryParam,"isActive",t)},expression:"queryParam.isActive"}},e._l(e.activeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),r("el-select",{staticClass:"select-bar",attrs:{clearable:"",placeholder:"状态"},model:{value:e.queryParam.serverStatus,callback:function(t){e.$set(e.queryParam,"serverStatus",t)},expression:"queryParam.serverStatus"}},e._l(e.serverStatusOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),r("el-select",{staticClass:"select-bar",attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词搜索标签","remote-method":e.getTag,loading:e.loading},model:{value:e.queryParam.tagId,callback:function(t){e.$set(e.queryParam,"tagId",t)},expression:"queryParam.tagId"}},e._l(e.tagOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.tagKey,value:e.id}})})),1),r("el-button",{staticClass:"button",on:{click:e.fetchData}},[e._v("查询")]),r("el-button",{staticClass:"button",on:{click:e.handlerAdd}},[e._v("新增")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[r("el-form-item",{attrs:{label:"服务器类型"}},[r("span",[e._v(e._s(e._f("getServerTypeText")(t.row.serverType)))])]),r("el-form-item",{attrs:{label:"服务器描述"}},[r("span",[e._v(e._s(t.row.comment))])]),r("el-form-item",{attrs:{label:"服务器组"}},[r("span",[e._v(e._s(t.row.serverGroup.name))])]),r("el-form-item",{attrs:{label:"服务器组描述"}},[r("span",[e._v(e._s(t.row.serverGroup.comment))])]),r("el-form-item",{attrs:{label:"服务器组类型"}},[r("el-tag",{style:{color:t.row.serverGroup.serverGroupType.color},attrs:{"disable-transitions":""}},[e._v(" "+e._s(t.row.serverGroup.serverGroupType.name)+" ")])],1),r("el-form-item",{attrs:{label:"登录类型"}},[r("span",[e._v(e._s(e._f("getLoginTypeText")(t.row.loginType)))])]),r("el-form-item",{attrs:{label:"登录用户"}},[r("span",[e._v(e._s(t.row.loginUser))])]),r("el-form-item",{attrs:{label:"区"}},[r("span",[e._v(e._s(t.row.area))])]),r("el-form-item",{attrs:{label:"监控状态"}},[r("el-tag",{attrs:{"disable-transitions":"",type:e._f("getMonitorStatusType")(t.row.monitorStatus)}},[e._v(e._s(e._f("getMonitorStatusText")(t.row.monitorStatus))+" ")])],1)],1)]}}])}),r("el-table-column",{attrs:{prop:"name",label:"名称"}}),r("el-table-column",{attrs:{prop:"serialNumber",label:"序号",width:"80",sortable:""}}),r("el-table-column",{attrs:{prop:"publicIp",label:"公网ip"}}),r("el-table-column",{attrs:{prop:"privateIp",label:"私网ip"}}),r("el-table-column",{attrs:{prop:"env",label:"环境",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{style:{color:t.row.env.color},attrs:{"disable-transitions":""}},[e._v(e._s(t.row.env.envName))])]}}])}),r("el-table-column",{attrs:{prop:"isActive",label:"有效",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{"disable-transitions":"",type:t.row.isActive?"success":"info"}},[e._v(e._s(t.row.isActive?"有效":"无效")+" ")])]}}])}),r("el-table-column",{attrs:{prop:"serverStatus",label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{"disable-transitions":"",type:e._f("getServerStatusType")(t.row.serverStatus)}},[e._v(e._s(e._f("getServerStatusText")(t.row.serverStatus))+" ")])]}}])}),r("el-table-column",{attrs:{prop:"tags",label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"tag-group"},e._l(t.row.tags,(function(t){return r("span",{key:t.id},[r("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:t.comment,placement:"top-start"}},[r("el-tag",{staticStyle:{"margin-left":"5px"},style:{color:t.color}},[e._v(e._s(t.tagKey))])],1)],1)})),0)]}}])}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(r){return e.handlerRowTagEdit(t.row)}}},[e._v("标签")]),r("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(r){return e.handlerRowEdit(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(r){return e.handlerXTerm(t.row)}}},[e._v("登录")]),r("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(r){return e.handlerRowDel(t.row)}}},[e._v("删除")])]}}])})],1),r("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize},on:{"current-change":e.paginationCurrentChange,"size-change":e.handleSizeChange}}),r("ServerDialog",{ref:"serverDialog",attrs:{formStatus:e.formServerStatus},on:{closeDialog:e.fetchData}}),r("TagTransferDialog",{ref:"tagTransferDialog",attrs:{formStatus:e.formTagTransferStatus},on:{closeDialog:e.fetchData}}),r("XTerm",{ref:"xtermDialog",attrs:{formStatus:e.formXtermStatus}})]],2)},n=[],s=(r("a4d3"),r("4de4"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("ade3")),i=r("5880"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.formStatus.operationType?e.formStatus.addTitle:e.formStatus.updateTitle,visible:e.formStatus.visible},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)},"before-close":e.handlerCloseDialog}},[r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"名称","label-width":e.formStatus.labelWidth,required:!0}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.serverData.name,callback:function(t){e.$set(e.serverData,"name","string"===typeof t?t.trim():t)},expression:"serverData.name"}})],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"服务器组","label-width":e.formStatus.labelWidth,required:!0}},[r("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"输入关键词搜组类型","remote-method":e.getServerGroup,loading:e.loading},model:{value:e.serverData.serverGroupId,callback:function(t){e.$set(e.serverData,"serverGroupId","string"===typeof t?t.trim():t)},expression:"serverData.serverGroupId"}},e._l(e.serverGroupOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"服务器类型","label-width":e.formStatus.labelWidth,required:!0}},[r("el-select",{attrs:{placeholder:"选择类型"},model:{value:e.serverData.serverType,callback:function(t){e.$set(e.serverData,"serverType",t)},expression:"serverData.serverType"}},e._l(e.serverTypeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"登录用户","label-width":e.formStatus.labelWidth}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.serverData.loginUser,callback:function(t){e.$set(e.serverData,"loginUser","string"===typeof t?t.trim():t)},expression:"serverData.loginUser"}})],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"登录类型","label-width":e.formStatus.labelWidth}},[r("el-select",{attrs:{placeholder:"选择类型"},model:{value:e.serverData.loginType,callback:function(t){e.$set(e.serverData,"loginType","string"===typeof t?t.trim():t)},expression:"serverData.loginType"}},e._l(e.loginTypeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"环境","label-width":e.formStatus.labelWidth,required:!0}},[r("el-select",{attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",loading:e.loading},model:{value:e.serverData.envType,callback:function(t){e.$set(e.serverData,"envType","string"===typeof t?t.trim():t)},expression:"serverData.envType"}},e._l(e.envTypeOptions,(function(e){return r("el-option",{key:e.envType,attrs:{label:e.envName,value:e.envType}})})),1)],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"区","label-width":e.formStatus.labelWidth}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.serverData.area,callback:function(t){e.$set(e.serverData,"area","string"===typeof t?t.trim():t)},expression:"serverData.area"}})],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"公网ip","label-width":e.formStatus.labelWidth}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.serverData.publicIp,callback:function(t){e.$set(e.serverData,"publicIp","string"===typeof t?t.trim():t)},expression:"serverData.publicIp"}})],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"私网ip","label-width":e.formStatus.labelWidth,required:!0}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.serverData.privateIp,callback:function(t){e.$set(e.serverData,"privateIp","string"===typeof t?t.trim():t)},expression:"serverData.privateIp"}})],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"序号","label-width":e.formStatus.labelWidth,required:!0}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.serverData.serialNumber,callback:function(t){e.$set(e.serverData,"serialNumber",e._n(t))},expression:"serverData.serialNumber"}})],1)],1),r("el-form",{attrs:{model:e.serverData}},[r("el-form-item",{attrs:{label:"描述","label-width":e.formStatus.labelWidth}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.serverData.comment,callback:function(t){e.$set(e.serverData,"comment","string"===typeof t?t.trim():t)},expression:"serverData.comment"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini"},on:{click:e.handlerCloseDialog}},[e._v("取消")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveInfo}},[e._v("确定")])],1)],1)},l=[],u=(r("b0c0"),r("4d63"),r("25f0"),r("5319"),r("c496")),c=r("b191"),d=r("e8b6"),p=r("604d"),f="SERVER_ACCOUNT",m=[{value:0,label:"server"},{value:1,label:"vmware vm"},{value:2,label:"aliyun ecs"},{value:3,label:"aws ec2"},{value:4,label:"tencent cvm"},{value:5,label:"vmware esxi"}],v=[{value:0,label:"key"},{value:1,label:"passwd"}],g={data:function(){return{loading:!1,envTypeOptions:[],serverGroupOptions:[],serverData:{},loginUser:"",serverTypeOptions:m,loginTypeOptions:v}},name:"ServerDialog",props:["formStatus"],mixins:[],mounted:function(){},methods:{setAccountSetting:function(){var e=this;Object(p["b"])(f).then((function(t){e.serverData.loginUser=t.body[f]}))},handlerCloseDialog:function(){this.formStatus.visible=!1,this.$emit("closeDialog")},getEnvType:function(){var e=this;Object(u["c"])("","",1,20).then((function(t){e.envTypeOptions=t.body.data}))},initData:function(e,t){var r=this;if(this.serverData=e,this.serverGroupOptions=t,this.getEnvType(),""===this.serverData.loginUser&&this.setAccountSetting(),"{}"===JSON.stringify(this.serverData.serverGroup)){var a=this.serverData.name.replace(new RegExp("-[0-9]+$"),"");Object(d["e"])(a,"",1,20).then((function(e){r.serverGroupOptions=e.body.data,"[]"!==JSON.stringify(r.serverGroupOptions)&&r.serverGroupOptions.length>=0&&(r.serverData.serveGroup=r.serverGroupOptions[0],r.serverData.serverGroupId=r.serverGroupOptions[0].id)}))}},handleClick:function(){this.$emit("input",!this.value)},getServerGroup:function(e){var t=this;Object(d["e"])(e,"",1,20).then((function(e){t.serverGroupOptions=e.body.data}))},saveInfo:function(){var e=this;setTimeout((function(){var t=Object.assign({},e.serverData);delete t.serverGroupOptions,delete t.serverGroup,delete t.envTypeOptions,delete t.tags,delete t.env,e.formStatus.operationType?Object(c["a"])(t).then((function(t){e.$message({message:"成功",type:"success"}),e.handlerCloseDialog()})):Object(c["f"])(t).then((function(t){e.$message({message:"成功",type:"success"}),e.handlerCloseDialog()}))}),600)}}},h=g,b=r("2877"),y=function(e){e.options.__source="src/components/opscloud/dialog/ServerDialog.vue"},S=y,O=Object(b["a"])(h,o,l,!1,null,null,null);"function"===typeof S&&S(O);var T=O.exports,D=r("04b5"),x=r("95ff");function k(e){switch(e){case 0:return"密钥";case 1:return"密码";default:return"未定义"}}function w(e){switch(e){case-1:return"未监控";case 0:return"启用";case 1:return"禁用";default:return"未定义"}}function _(e){switch(e){case-1:return"info";case 0:return"success";case 1:return"warning";default:return"danger"}}function I(e){switch(e){case 0:return"server";case 1:return"vmware vm";case 2:return"aliyun ecs";case 3:return"aws ec2";case 4:return"tencent cvm";case 5:return"vmware esxi";case 6:return"zabbix host";default:return"未定义"}}function j(e){switch(e){case 0:return"info";case 1:return"success";case-1:return"warning";default:return"danger"}}function $(e){switch(e){case 0:return"离线";case 1:return"在线";case-1:return"不确定";default:return"未定义"}}var C=r("a3e9");function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=[{value:!0,label:"有效"},{value:!1,label:"无效"}],P=[{value:0,label:"离线"},{value:1,label:"在线"},{value:-1,label:"未知"}],z={data:function(){return{formTagTransferStatus:{visible:!1,title:"编辑服务器标签"},formServerStatus:{visible:!1,labelWidth:"150px",operationType:!0,addTitle:"新增服务器配置",updateTitle:"更新服务器配置"},formXtermStatus:{visible:!1},tableData:[],options:{stripe:!0},loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{queryName:"",serverGroupId:"",envType:"",tagId:"",isActive:"",serverStatus:""},title:"服务器信息",tagOptions:[],envTypeOptions:[],serverGroupOptions:[],businessType:1,activeOptions:E,serverStatusOptions:P}},mounted:function(){this.initPageSize(),this.fetchData(),this.getEnvType(),this.getTag("")},computed:q({},Object(i["mapState"])("d2admin/user",["info"])),components:{ServerDialog:T,TagTransferDialog:D["a"],XTerm:x["a"]},filters:{getLoginTypeText:k,getMonitorStatusText:w,getMonitorStatusType:_,getServerTypeText:I,getServerStatusType:j,getServerStatusText:$},methods:q({},Object(i["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(e){this.pagination.pageSize=e,this.info.pageSize=e,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},getTag:function(e){var t=this;Object(C["d"])(e,1,100).then((function(e){t.tagOptions=e.body.data}))},getEnvType:function(){var e=this;Object(u["c"])("","",1,20).then((function(t){e.envTypeOptions=t.body.data}))},getServerGroup:function(e){var t=this;Object(d["e"])(e,"",1,20).then((function(e){t.serverGroupOptions=e.body.data}))},handleClick:function(){this.$emit("input",!this.value)},handlerXTerm:function(e){this.formXtermStatus.visible=!0,this.$refs.xtermDialog.initData(e)},handlerRowDel:function(e){var t=this;this.$confirm("此操作将删除当前配置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["b"])(e.id).then((function(e){t.fetchData(),t.$message({type:"success",message:"删除成功!"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handlerRowTagEdit:function(e){this.formTagTransferStatus.visible=!0;var t={businessId:e.id,businessType:this.businessType,tagIds:[],tagOptions:[]};Object(C["d"])("",1,100).then((function(e){t.tagOptions=e.body.data})),Object(C["c"])(this.businessType,t.businessId,"").then((function(e){for(var r in e.body)t.tagIds.push(e.body[r].id)})),this.formTagTransferStatus.visible=!0,this.$refs.tagTransferDialog.initData(t)},handlerRowEdit:function(e){var t=Object.assign({},e),r=[];r.push(t.serverGroup),this.formServerStatus.visible=!0,this.formServerStatus.operationType=!1,this.$refs.serverDialog.initData(t,r)},handlerAdd:function(){this.formServerStatus.operationType=!0,this.formServerStatus.visible=!0;var e={serverGroup:"",id:"",name:"",serverGroupId:"",loginType:0,loginUser:"",envType:4,publicIp:"",privateIp:"",serverType:0,area:"",serialNumber:0,monitorStatus:-1,comment:"",serverGroupOptions:[]};this.$refs.serverDialog.initData(e)},handleDialogCancel:function(e){this.$message({message:"取消保存",type:"warning"}),e()},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.loading=!0;var t=Object.assign({},this.queryParam);t.extend=1,t.page=this.pagination.currentPage,t.length=this.pagination.pageSize,Object(c["c"])(t).then((function(t){e.tableData=t.body.data,e.pagination.total=t.body.totalNum,e.loading=!1}))}})},N=z,M=(r("9ce0"),function(e){e.options.__source="src/pages/server/index.vue"}),R=M,A=Object(b["a"])(N,a,n,!1,null,null,null);"function"===typeof R&&R(A);t["default"]=A.exports},b191:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return s})),r.d(t,"f",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return u}));var a=r("9bd2");function n(e){return Object(a["a"])({url:"/server/page/fuzzy/query",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/server/add",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/server/update",method:"put",data:e})}function o(e){return Object(a["a"])({url:"/server/del?id="+e,method:"delete"})}function l(e){return Object(a["a"])({url:"/server/attribute/query?id="+e,method:"get"})}function u(e){return Object(a["a"])({url:"/server/attribute/save",method:"put",data:e})}},c496:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return o}));var a=r("9bd2");function n(e,t,r,n){return Object(a["a"])({url:"/env/page/query?envName="+e+"&envType="+t+"&page="+r+"&length="+n,method:"get"})}function s(e){return Object(a["a"])({url:"/env/add",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/env/del?id="+e,method:"delete"})}function o(e){return Object(a["a"])({url:"/env/update",method:"put",data:e})}},e8b6:function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i})),r.d(t,"j",(function(){return o})),r.d(t,"g",(function(){return l})),r.d(t,"f",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"h",(function(){return d})),r.d(t,"d",(function(){return p})),r.d(t,"i",(function(){return f}));var a=r("9bd2");function n(e,t,r,n){return Object(a["a"])({url:"/server/group/page/query?name="+e+"&grpType="+t+"&page="+r+"&length="+n,method:"get"})}function s(e){return Object(a["a"])({url:"/server/group/add",method:"post",data:e})}function i(e){return Object(a["a"])({url:"/server/group/del?id="+e,method:"delete"})}function o(e){return Object(a["a"])({url:"/server/group/update",method:"put",data:e})}function l(e,t,r){return Object(a["a"])({url:"/server/group/user/include/page/query?userId="+e+"&page="+t+"&length="+r,method:"get"})}function u(e,t,r,n){return Object(a["a"])({url:"/server/group/user/exclude/page/query?userId="+e+"&queryName="+t+"&page="+r+"&length="+n,method:"get"})}function c(e,t){return Object(a["a"])({url:"/server/group/grant?userId="+e+"&serverGroupId="+t,method:"get"})}function d(e,t){return Object(a["a"])({url:"/server/group/revoke?userId="+e+"&serverGroupId="+t,method:"delete"})}function p(e){return Object(a["a"])({url:"/server/group/attribute/query?id="+e,method:"get"})}function f(e){return Object(a["a"])({url:"/server/group/attribute/save",method:"put",data:e})}}}]);