(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9b3c6ff6"],{"1de2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[[a("div",[a("h1",[e._v(e._s(e.title))])]),a("div",{staticStyle:{"margin-bottom":"5px"}},[a("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:24}},[a("el-input",{staticStyle:{display:"inline-block","max-width":"200px","margin-left":"10px"},attrs:{placeholder:"输入关键字模糊查询"},model:{value:e.queryParam.queryName,callback:function(t){e.$set(e.queryParam,"queryName","string"===typeof t?t.trim():t)},expression:"queryParam.queryName"}}),a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:e.fetchData}},[e._v("查询")]),a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:e.syncLdapUser}},[e._v("同步")]),a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:e.addItem}},[e._v("新建")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[null!=t.row.name&&""!=t.row.name?a("el-form-item",{attrs:{label:"姓名"}},[a("span",[e._v(e._s(t.row.name))])]):e._e(),null!=t.row.phone&&""!=t.row.phone?a("el-form-item",{attrs:{label:"电话"}},[a("span",[e._v(e._s(t.row.phone))])]):e._e(),null!=t.row.wechat&&""!=t.row.wechat?a("el-form-item",{attrs:{label:"微信"}},[a("span",[e._v(e._s(t.row.wechat))])]):e._e(),null!=t.row.source&&""!=t.row.source?a("el-form-item",{attrs:{label:"数据源"}},[a("span",[e._v(e._s(t.row.source))])]):e._e(),a("el-form-item",{attrs:{label:"用户组"}},[a("div",{staticClass:"tag-group"},e._l(t.row.userGroups,(function(t){return a("el-tag",{key:t.id,staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.name)+" ")])})),1)]),a("el-form-item",{attrs:{label:"服务器组"}},[a("div",{staticClass:"tag-group"},e._l(t.row.serverGroups,(function(t){return a("span",{key:t.id},[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:t.comment||"没有填写",placement:"bottom"}},[a("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{type:t.isAdmin?"danger":""}},[e._v(e._s(t.name))])],1)],1)})),0)])],1)]}}])}),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),a("el-table-column",{attrs:{prop:"displayName",label:"显示名"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"userGroups.length",label:"用户组"}}),a("el-table-column",{attrs:{prop:"serverGroups.length",label:"服务器组"}}),a("el-table-column",{attrs:{prop:"ramUsers.length",label:"阿里云RAM账户"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"380"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return e.editItem(t.row)}}},[e._v("编辑")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"用户组授权",placement:"top-start"}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-user-solid"},on:{click:function(a){return e.editUserGroup(t.row)}}},[e._v(" 授权 ")])],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"服务器组授权",placement:"top-start"}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"fa fa-server"},on:{click:function(a){return e.editServerGroup(t.row)}}},[e._v("授权 ")])],1),a("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(a){return e.retireUser(t.row)}}},[e._v("离职")])]}}])})],1),a("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize},on:{"current-change":e.paginationCurrentChange,"size-change":e.handleSizeChange}}),a("UserDialog",{ref:"userDialog",attrs:{formStatus:e.formUserStatus},on:{closeDialog:e.fetchData}}),a("UserUserGroupDialog",{ref:"userUserGroupDialog",attrs:{formStatus:e.formUserUserGroupStatus},on:{closeUserUserGroupDialog:e.fetchData}}),a("UserServerGroupDialog",{ref:"userServerGroupDialog",attrs:{formStatus:e.formUserServerGroupStatus},on:{closeUserServerGroupDialog:e.fetchData}})]],2)},i=[],n=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),s=a("5880"),o=a("f086"),l=a("c04d"),c=a("8c2af"),u=a("2d8e");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m={data:function(){return{formUserStatus:{visible:!1,labelWidth:"150px",operationType:!0,addTitle:"新增用户信息",updateTitle:"更新用户信息"},formUserUserGroupStatus:{visible:!1,labelWidth:"150px",title:"用户组授权"},formUserServerGroupStatus:{visible:!1,labelWidth:"150px",title:"服务器组授权"},tableData:[],options:{stripe:!0},loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{queryName:"",isActive:!0},title:"用户管理"}},computed:f({},Object(s["mapState"])("d2admin/user",["info"])),mounted:function(){this.initPageSize(),this.fetchData()},components:{UserDialog:o["a"],UserUserGroupDialog:l["a"],UserServerGroupDialog:c["a"]},methods:f({},Object(s["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(e){this.pagination.pageSize=e,this.info.pageSize=e,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},retireUser:function(e){var t=this;this.$confirm("确认用户离职操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["j"])(e.id).then((function(e){t.fetchData(),t.$message({type:"success",message:"离职成功!"})}))})).catch((function(){t.$message({type:"info",message:"已取消操作"})}))},editItem:function(e){var t=Object.assign({},e);this.$refs.userDialog.initData(t),this.formUserStatus.visible=!0,this.formUserStatus.operationType=!1},editUserGroup:function(e){var t=Object.assign({},e);this.$refs.userUserGroupDialog.initData(t),this.formUserUserGroupStatus.visible=!0},editServerGroup:function(e){var t=Object.assign({},e);this.$refs.userServerGroupDialog.initData(t),this.formUserServerGroupStatus.visible=!0},addItem:function(){var e={id:"",username:"",name:"",displayName:"",wechat:"",email:"",phone:"",comment:""};this.$refs.userDialog.initData(e),this.formUserStatus.visible=!0,this.formUserStatus.operationType=!0},handleDialogCancel:function(e){this.$message({message:"取消保存",type:"warning"}),e()},syncLdapUser:function(){var e=this;setTimeout((function(){e.loading=!0,Object(u["l"])().then((function(t){e.$message({message:"同步成功",type:"success"}),e.fetchData()}))}),300)},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.loading=!0;var t={queryName:this.queryParam.queryName,isActive:this.queryParam.isActive,extend:1,page:this.pagination.currentPage,length:this.pagination.pageSize};Object(u["e"])(t).then((function(t){e.tableData=t.body.data,e.pagination.total=t.body.totalNum,e.loading=!1}))}})},g=m,d=(a("9b42"),a("2877")),h=function(e){e.options.__source="src/pages/user/index.vue"},b=h,y=Object(d["a"])(g,r,i,!1,null,"6fd095c0",null);"function"===typeof b&&b(y);t["default"]=y.exports},"9b42":function(e,t,a){"use strict";var r=a("cddf"),i=a.n(r);i.a},cddf:function(e,t,a){}}]);