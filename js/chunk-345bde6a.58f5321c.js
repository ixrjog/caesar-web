(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-345bde6a"],{"2d8e":function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"g",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"m",(function(){return u})),a.d(t,"j",(function(){return l})),a.d(t,"d",(function(){return d})),a.d(t,"f",(function(){return c})),a.d(t,"l",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"k",(function(){return g})),a.d(t,"i",(function(){return b}));var r=a("9bd2");function n(e,t,a,n){return Object(r["a"])({url:"/user/page/query?username="+e+"&extend="+t+"&page="+a+"&length="+n,method:"get"})}function o(){return Object(r["a"])({url:"/user/detail",method:"get"})}function i(e){return Object(r["a"])({url:"/user/page/fuzzy/query",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/user/create",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/user/update",method:"put",data:e})}function l(e){return Object(r["a"])({url:"/user/retire?id="+e,method:"put"})}function d(e){return Object(r["a"])({url:"/user/del?id="+e,method:"delete"})}function c(){return Object(r["a"])({url:"/user/password/random",method:"get"})}function p(){return Object(r["a"])({url:"/user/ldap/sync",method:"get"})}function m(e){return Object(r["a"])({url:"/user/token/apply",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/user/token/del?id="+e,method:"delete"})}function g(e){return Object(r["a"])({url:"/user/credential/save",method:"post",data:e})}function b(e){return Object(r["a"])({url:"/user/server/tree/query",method:"post",data:e})}},5733:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[[a("div",[a("h1",[e._v(e._s(e.title))])]),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-select",{style:e.searchBarStyle,attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"搜索部门","remote-method":e.getDepartment,loading:e.getDepartmentLoading},model:{value:e.treeDepartmentId,callback:function(t){e.treeDepartmentId="string"===typeof t?t.trim():t},expression:"treeDepartmentId"}},e._l(e.departmentOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{loading:e.searching},on:{click:e.fetchDeptTreeData}},[e._v(" 查询 ")]),a("el-button",{on:{click:e.addDepartment}},[e._v("新增")]),a("span",{staticStyle:{float:"right"}},[e._v("组织架构")])],1),a("el-tree",{attrs:{draggable:"","default-expand-all":"","highlight-current":"","node-key":"id",data:e.deptTree.tree},on:{"node-drop":e.handleDrop,"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,n=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(r.label))]),a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.editDepartment(r,n)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.delDepartment(r,n)}}},[e._v("删除")])],1)])}}])})],1)],1),a("el-col",{attrs:{span:16}},[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("部门成员")]),null!=e.pagination&&null!=e.pagination.total?a("el-tag",{staticStyle:{float:"right"},attrs:{"disable-transitions":""}},[e._v(" SIZE: "+e._s(e.pagination.total)+" ")]):e._e()],1),a("div",{staticStyle:{"margin-bottom":"5px"}},[a("el-row",{staticStyle:{"margin-bottom":"5px"}},[a("el-select",{style:e.searchBarStyle,attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"搜索用户","remote-method":e.getUser,loading:e.getUserLoading},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}},e._l(e.userOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.displayName,value:e.id}})})),1),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{disabled:""==e.departmentId||""==e.userId},on:{click:e.addDeptMember}},[e._v("添加 ")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"加入部门，成为此部门成员",placement:"top"}},[a("el-button",{staticStyle:{"margin-left":"5px"},on:{click:e.joinDeptMember}},[e._v("加入")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberLoading,expression:"memberLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),a("el-table-column",{attrs:{prop:"displayName",label:"显示名"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.memberType?a("i",{staticClass:"fa fa-gg-circle",attrs:{"aria-hidden":"true"}}):e._e(),1===t.row.memberType?a("span",{staticStyle:{color:"#2f74ff"}},[e._v(e._s(t.row.displayName))]):e._e(),0===t.row.memberType?a("span",[e._v(e._s(t.row.displayName))]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"isLeader",label:"经理",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.isLeader?a("el-tag",{attrs:{type:"success",size:"small"}},[e._v("是")]):e._e(),0===t.row.isLeader?a("el-tag",{attrs:{type:"info",size:"small"}},[e._v("否")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"isApprovalAuthority",label:"审批权",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.isApprovalAuthority?a("el-tag",{attrs:{type:"success",size:"small"}},[e._v("是")]):e._e(),0===t.row.isApprovalAuthority?a("el-tag",{attrs:{type:"info",size:"small"}},[e._v("否")]):e._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return e.setDeptMemberLeader(t.row)}}},[e._v("经理")]),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return e.setDeptMemberApproval(t.row)}}},[e._v("审批")]),a("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(a){return e.removeDeptMember(t.row)}}},[e._v("移除")])]}}])})],1),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize},on:{"current-change":e.paginationCurrentChange}})],1)],1)],1),a("DepartmentDialog",{ref:"departmentDialog",attrs:{formStatus:e.formDepartmentStatus},on:{closeDepartmentDialog:e.fetchDeptTreeData}})]],2)},n=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.formStatus.operationType?e.formStatus.addTitle:e.formStatus.updateTitle,visible:e.formStatus.visible},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)}}},[a("el-form",{attrs:{model:e.departmentData}},[a("el-form-item",{attrs:{label:"部门名称","label-width":e.formStatus.labelWidth,prop:"name",required:!0}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.departmentData.name,callback:function(t){e.$set(e.departmentData,"name",t)},expression:"departmentData.name"}})],1)],1),a("el-form",{attrs:{model:e.departmentData}},[a("el-form-item",{attrs:{label:"部门类型","label-width":e.formStatus.labelWidth,prop:"deptType",required:!0}},[a("el-select",{attrs:{placeholder:"选择类型"},model:{value:e.departmentData.deptType,callback:function(t){e.$set(e.departmentData,"deptType",t)},expression:"departmentData.deptType"}},e._l(e.deptTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-form",{attrs:{model:e.departmentData}},[a("el-form-item",{attrs:{label:"描述","label-width":e.formStatus.labelWidth}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.departmentData.comment,callback:function(t){e.$set(e.departmentData,"comment",t)},expression:"departmentData.comment"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.formStatus.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveInfo}},[e._v("确定")])],1)],1)},i=[],s=a("9037"),u={data:function(){return{departmentData:{},deptTypeOptions:[{value:0,label:"普通部门"},{value:1,label:"技术部"}]}},name:"DepartmentDialog",props:["formStatus"],mixins:[],mounted:function(){},methods:{initData:function(e){this.departmentData=e},handleClick:function(){this.$emit("input",!this.value)},saveInfo:function(){var e=this;setTimeout((function(){var t=Object.assign({},e.departmentData);e.formStatus.operationType?Object(s["a"])(t).then((function(t){e.$message({message:"成功",type:"success"}),e.formStatus.visible=!1,e.$emit("closeDepartmentDialog")})):Object(s["l"])(t).then((function(t){e.$message({message:"成功",type:"success"}),e.formStatus.visible=!1,e.$emit("closeDepartmentDialog")}))}),600)}}},l=u,d=a("2877"),c=function(e){e.options.__source="src/components/opscloud/dialog/DepartmentDialog.vue"},p=c,m=Object(d["a"])(l,o,i,!1,null,null,null);"function"===typeof p&&p(m);var f=m.exports,g=a("2d8e"),b={data:function(){return{searchBarHeadStyle:{display:"inline-block",maxWidth:"200px"},searchBarStyle:{marginLeft:"5px"},title:"部门管理",departmentName:"",rootParentId:0,departmentId:"",deptTree:"",searching:!1,loading:!1,tableData:[],memberLoading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryMemberParam:{queryName:""},treeDepartmentId:"",departmentOptions:[],getDepartmentLoading:!1,userId:"",getUserLoading:!1,userOptions:[],formDepartmentStatus:{visible:!1,labelWidth:"150px",operationType:!0,addTitle:"新增部门信息",updateTitle:"更新部门信息"}}},mounted:function(){this.fetchDeptTreeData()},components:{DepartmentDialog:f},methods:{getDepartment:function(e){var t=this;this.getDepartmentLoading=!0;var a={queryName:e,page:1,length:20};Object(s["h"])(a).then((function(e){t.departmentOptions=e.body.data,t.getDepartmentLoading=!1}))},getUser:function(e){var t=this;this.getUserLoading=!0;var a={queryName:e,extend:0,page:1,length:20};Object(g["e"])(a).then((function(e){t.userOptions=e.body.data,t.getUserLoading=!1}))},addDeptMember:function(){var e=this;""!==this.departmentId&&""!==this.userId&&Object(s["b"])(this.departmentId,this.userId).then((function(t){t.success?(e.$message({type:"success",message:"添加部门成员成功!"}),e.fetchDeptMemberData()):e.$message.error(t.msg)}))},joinDeptMember:function(){var e=this;""!==this.departmentId&&Object(s["e"])(this.departmentId).then((function(t){t.success?(e.$message({type:"success",message:"加入部门成功!"}),e.fetchDeptMemberData()):e.$message.error(t.msg)}))},addDepartment:function(){var e={id:0,name:"",comment:"",parentId:""!==this.treeDepartmentId?this.treeDepartmentId:1,deptType:0};this.formDepartmentStatus.visible=!0,this.formDepartmentStatus.operationType=!0,this.$refs.departmentDialog.initData(e)},editDepartment:function(e,t){var a=this;Object(s["f"])(e.key).then((function(e){if(e.success){var t=e.body;a.formDepartmentStatus.visible=!0,a.formDepartmentStatus.operationType=!1,a.$refs.departmentDialog.initData(t)}}))},delDepartment:function(e,t){},setDeptMemberLeader:function(e){var t=this;Object(s["n"])(e.id).then((function(e){e.success?(t.$message({type:"success",message:"设置部门成员经理属性成功!"}),t.fetchDeptMemberData()):t.$message.error(e.msg)}))},setDeptMemberApproval:function(e){var t=this;Object(s["m"])(e.id).then((function(e){e.success?(t.$message({type:"success",message:"设置部门成员审批权属性成功!"}),t.fetchDeptMemberData()):t.$message.error(e.msg)}))},removeDeptMember:function(e){var t=this;Object(s["k"])(e.id).then((function(e){e.success?(t.$message({type:"success",message:"移除部门成员成功!"}),t.fetchDeptMemberData()):t.$message.error(e.msg)}))},handleDrop:function(e,t,a,r){var n=this;Object(s["d"])(e.key,t.key,a).then((function(e){e.success?(n.$message({type:"success",message:"设置成功!"}),n.fetchDeptTreeData()):n.$message.error(e.msg)}))},handleNodeClick:function(e,t){try{this.departmentId=t.key,this.departmentName=t.label,this.fetchDeptMemberData()}catch(a){}},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchDeptMemberData()},fetchDeptTreeData:function(){var e=this;this.searching=!0;var t=""===this.treeDepartmentId?this.rootParentId:this.treeDepartmentId;Object(s["i"])(t).then((function(t){e.deptTree=t.body,e.searching=!1}))},fetchDeptMemberData:function(){var e=this;if(null!==this.departmentId&&""!==this.departmentId){this.memberLoading=!0;var t={departmentId:this.departmentId,queryName:this.queryMemberParam.queryName,memberType:-1,isLeader:-1,isApprovalAuthority:-1,page:this.pagination.currentPage,length:this.pagination.pageSize};Object(s["g"])(t).then((function(t){e.tableData=t.body.data,e.pagination.total=t.body.totalNum,e.memberLoading=!1}))}}}},h=b,y=(a("b475"),function(e){e.options.__source="src/pages/org/department/index.vue"}),D=y,v=Object(d["a"])(h,r,n,!1,null,"7fcafbda",null);"function"===typeof D&&D(v);t["default"]=v.exports},9037:function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"i",(function(){return o})),a.d(t,"j",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return u})),a.d(t,"l",(function(){return l})),a.d(t,"f",(function(){return d})),a.d(t,"g",(function(){return c})),a.d(t,"b",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"k",(function(){return f})),a.d(t,"n",(function(){return g})),a.d(t,"m",(function(){return b})),a.d(t,"c",(function(){return h}));var r=a("9bd2");function n(e){return Object(r["a"])({url:"/org/department/page/query",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/org/department/tree/query?parentId="+e,method:"get"})}function i(e){return Object(r["a"])({url:"/org/chart/query?parentId="+e,method:"get"})}function s(e,t,a){return Object(r["a"])({url:"/org/department/tree/drop?draggingParentId="+e+"&dropParentId="+t+"&dropType="+a,method:"get"})}function u(e){return Object(r["a"])({url:"/org/department/add",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/org/department/update",method:"put",data:e})}function d(e){return Object(r["a"])({url:"/org/department/query?id="+e,method:"get"})}function c(e){return Object(r["a"])({url:"/org/department/member/page/query",method:"post",data:e})}function p(e,t){return Object(r["a"])({url:"/org/department/member/add?departmentId="+e+"&userId="+t,method:"put"})}function m(e){return Object(r["a"])({url:"/org/department/member/join?departmentId="+e,method:"put"})}function f(e){return Object(r["a"])({url:"/org/department/member/remove?id="+e,method:"delete"})}function g(e){return Object(r["a"])({url:"/org/department/member/leader/update?id="+e,method:"put"})}function b(e){return Object(r["a"])({url:"/org/department/member/approval/update?id="+e,method:"put"})}function h(){return Object(r["a"])({url:"/org/department/user/check",method:"get"})}},b475:function(e,t,a){"use strict";var r=a("b945"),n=a.n(r);n.a},b945:function(e,t,a){}}]);