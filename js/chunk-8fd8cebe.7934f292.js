(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8fd8cebe"],{"04b5":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.formStatus.title,visible:e.formStatus.visible},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)}}},[n("el-form",{attrs:{model:e.tagTransfer}},[n("el-transfer",{attrs:{props:{key:"id",label:"tagKey"},data:e.tagTransfer.tagOptions,titles:["所有标签","当前标签"]},model:{value:e.tagTransfer.tagIds,callback:function(t){e.$set(e.tagTransfer,"tagIds",t)},expression:"tagTransfer.tagIds"}})],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(t){e.formStatus.visible=!1}}},[e._v("关闭")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handlerSave}},[e._v("确定")])],1)],1)},i=[],o=n("a3e9"),r={data:function(){return{tagTransfer:{}}},name:"TagTransferDialog",props:["formStatus"],mixins:[],mounted:function(){},methods:{handleClick:function(){this.$emit("input",!this.value)},initData:function(e){this.tagTransfer=e},handlerSave:function(){var e=this;setTimeout((function(){Object(o["f"])(e.tagTransfer).then((function(t){e.$message({message:"成功",type:"success"}),e.formStatus.visible=!1,e.$emit("closeDialog")}))}),600)}}},l=r,s=n("2877"),u=function(e){e.options.__source="src/components/opscloud/dialog/TagTransferDialog.vue"},c=u,d=Object(s["a"])(l,a,i,!1,null,null,null);"function"===typeof c&&c(d);t["a"]=d.exports},"058d":function(e,t){ace.define("ace/snippets/xml",["require","exports","module"],(function(e,t,n){"use strict";t.snippetText=void 0,t.scope="xml"}))},"0696":function(e,t,n){ace.define("ace/mode/xml_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,t,n){"use strict";var a=e("../lib/oop"),i=e("./text_highlight_rules").TextHighlightRules,o=function(e){var t="[_:a-zA-ZÀ-￿][-_:.a-zA-Z0-9À-￿]*";this.$rules={start:[{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\[",next:"cdata"},{token:["punctuation.instruction.xml","keyword.instruction.xml"],regex:"(<\\?)("+t+")",next:"processing_instruction"},{token:"comment.start.xml",regex:"<\\!--",next:"comment"},{token:["xml-pe.doctype.xml","xml-pe.doctype.xml"],regex:"(<\\!)(DOCTYPE)(?=[\\s])",next:"doctype",caseInsensitive:!0},{include:"tag"},{token:"text.end-tag-open.xml",regex:"</"},{token:"text.tag-open.xml",regex:"<"},{include:"reference"},{defaultToken:"text.xml"}],processing_instruction:[{token:"entity.other.attribute-name.decl-attribute-name.xml",regex:t},{token:"keyword.operator.decl-attribute-equals.xml",regex:"="},{include:"whitespace"},{include:"string"},{token:"punctuation.xml-decl.xml",regex:"\\?>",next:"start"}],doctype:[{include:"whitespace"},{include:"string"},{token:"xml-pe.doctype.xml",regex:">",next:"start"},{token:"xml-pe.xml",regex:"[-_a-zA-Z0-9:]+"},{token:"punctuation.int-subset",regex:"\\[",push:"int_subset"}],int_subset:[{token:"text.xml",regex:"\\s+"},{token:"punctuation.int-subset.xml",regex:"]",next:"pop"},{token:["punctuation.markup-decl.xml","keyword.markup-decl.xml"],regex:"(<\\!)("+t+")",push:[{token:"text",regex:"\\s+"},{token:"punctuation.markup-decl.xml",regex:">",next:"pop"},{include:"string"}]}],cdata:[{token:"string.cdata.xml",regex:"\\]\\]>",next:"start"},{token:"text.xml",regex:"\\s+"},{token:"text.xml",regex:"(?:[^\\]]|\\](?!\\]>))+"}],comment:[{token:"comment.end.xml",regex:"--\x3e",next:"start"},{defaultToken:"comment.xml"}],reference:[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],attr_reference:[{token:"constant.language.escape.reference.attribute-value.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],tag:[{token:["meta.tag.punctuation.tag-open.xml","meta.tag.punctuation.end-tag-open.xml","meta.tag.tag-name.xml"],regex:"(?:(<)|(</))((?:"+t+":)?"+t+")",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start"}]}],tag_whitespace:[{token:"text.tag-whitespace.xml",regex:"\\s+"}],whitespace:[{token:"text.whitespace.xml",regex:"\\s+"}],string:[{token:"string.xml",regex:"'",push:[{token:"string.xml",regex:"'",next:"pop"},{defaultToken:"string.xml"}]},{token:"string.xml",regex:'"',push:[{token:"string.xml",regex:'"',next:"pop"},{defaultToken:"string.xml"}]}],attributes:[{token:"entity.other.attribute-name.xml",regex:t},{token:"keyword.operator.attribute-equals.xml",regex:"="},{include:"tag_whitespace"},{include:"attribute_value"}],attribute_value:[{token:"string.attribute-value.xml",regex:"'",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]}]},this.constructor===o&&this.normalizeRules()};(function(){this.embedTagRules=function(e,t,n){this.$rules.tag.unshift({token:["meta.tag.punctuation.tag-open.xml","meta.tag."+n+".tag-name.xml"],regex:"(<)("+n+"(?=\\s|>|$))",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:t+"start"}]}),this.$rules[n+"-end"]=[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start",onMatch:function(e,t,n){return n.splice(0),this.token}}],this.embedRules(e,t,[{token:["meta.tag.punctuation.end-tag-open.xml","meta.tag."+n+".tag-name.xml"],regex:"(</)("+n+"(?=\\s|>|$))",next:n+"-end"},{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\["},{token:"string.cdata.xml",regex:"\\]\\]>"}])}}).call(i.prototype),a.inherits(o,i),t.XmlHighlightRules=o})),ace.define("ace/mode/behaviour/xml",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],(function(e,t,n){"use strict";var a=e("../../lib/oop"),i=e("../behaviour").Behaviour,o=e("../../token_iterator").TokenIterator;e("../../lib/lang");function r(e,t){return e.type.lastIndexOf(t+".xml")>-1}var l=function(){this.add("string_dquotes","insertion",(function(e,t,n,a,i){if('"'==i||"'"==i){var l=i,s=a.doc.getTextRange(n.getSelectionRange());if(""!==s&&"'"!==s&&'"'!=s&&n.getWrapBehavioursEnabled())return{text:l+s+l,selection:!1};var u=n.getCursorPosition(),c=a.doc.getLine(u.row),d=c.substring(u.column,u.column+1),p=new o(a,u.row,u.column),g=p.getCurrentToken();if(d==l&&(r(g,"attribute-value")||r(g,"string")))return{text:"",selection:[1,1]};if(g||(g=p.stepBackward()),!g)return;while(r(g,"tag-whitespace")||r(g,"whitespace"))g=p.stepBackward();var m=!d||d.match(/\s/);if(r(g,"attribute-equals")&&(m||">"==d)||r(g,"decl-attribute-equals")&&(m||"?"==d))return{text:l+l,selection:[1,1]}}})),this.add("string_dquotes","deletion",(function(e,t,n,a,i){var o=a.doc.getTextRange(i);if(!i.isMultiLine()&&('"'==o||"'"==o)){var r=a.doc.getLine(i.start.row),l=r.substring(i.start.column+1,i.start.column+2);if(l==o)return i.end.column++,i}})),this.add("autoclosing","insertion",(function(e,t,n,a,i){if(">"==i){var l=n.getSelectionRange().start,s=new o(a,l.row,l.column),u=s.getCurrentToken()||s.stepBackward();if(!u||!(r(u,"tag-name")||r(u,"tag-whitespace")||r(u,"attribute-name")||r(u,"attribute-equals")||r(u,"attribute-value")))return;if(r(u,"reference.attribute-value"))return;if(r(u,"attribute-value")){var c=u.value.charAt(0);if('"'==c||"'"==c){var d=u.value.charAt(u.value.length-1),p=s.getCurrentTokenColumn()+u.value.length;if(p>l.column||p==l.column&&c!=d)return}}while(!r(u,"tag-name"))if(u=s.stepBackward(),"<"==u.value){u=s.stepForward();break}var g=s.getCurrentTokenRow(),m=s.getCurrentTokenColumn();if(r(s.stepBackward(),"end-tag-open"))return;var f=u.value;if(g==l.row&&(f=f.substring(0,l.column-m)),this.voidElements.hasOwnProperty(f.toLowerCase()))return;return{text:"></"+f+">",selection:[1,1]}}})),this.add("autoindent","insertion",(function(e,t,n,a,i){if("\n"==i){var r=n.getCursorPosition(),l=a.getLine(r.row),s=new o(a,r.row,r.column),u=s.getCurrentToken();if(u&&-1!==u.type.indexOf("tag-close")){if("/>"==u.value)return;while(u&&-1===u.type.indexOf("tag-name"))u=s.stepBackward();if(!u)return;var c=u.value,d=s.getCurrentTokenRow();if(u=s.stepBackward(),!u||-1!==u.type.indexOf("end-tag"))return;if(this.voidElements&&!this.voidElements[c]){var p=a.getTokenAt(r.row,r.column+1),g=(l=a.getLine(d),this.$getIndent(l)),m=g+a.getTabString();return p&&"</"===p.value?{text:"\n"+m+"\n"+g,selection:[1,m.length,1,m.length]}:{text:"\n"+m}}}}}))};a.inherits(l,i),t.XmlBehaviour=l})),ace.define("ace/mode/folding/xml",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/range","ace/mode/folding/fold_mode","ace/token_iterator"],(function(e,t,n){"use strict";var a=e("../../lib/oop"),i=(e("../../lib/lang"),e("../../range").Range),o=e("./fold_mode").FoldMode,r=e("../../token_iterator").TokenIterator,l=t.FoldMode=function(e,t){o.call(this),this.voidElements=e||{},this.optionalEndTags=a.mixin({},this.voidElements),t&&a.mixin(this.optionalEndTags,t)};a.inherits(l,o);var s=function(){this.tagName="",this.closing=!1,this.selfClosing=!1,this.start={row:0,column:0},this.end={row:0,column:0}};function u(e,t){return e.type.lastIndexOf(t+".xml")>-1}(function(){this.getFoldWidget=function(e,t,n){var a=this._getFirstTagInLine(e,n);return a?a.closing||!a.tagName&&a.selfClosing?"markbeginend"==t?"end":"":!a.tagName||a.selfClosing||this.voidElements.hasOwnProperty(a.tagName.toLowerCase())?"":this._findEndTagInLine(e,n,a.tagName,a.end.column)?"":"start":this.getCommentFoldWidget(e,n)},this.getCommentFoldWidget=function(e,t){return/comment/.test(e.getState(t))&&/<!-/.test(e.getLine(t))?"start":""},this._getFirstTagInLine=function(e,t){for(var n=e.getTokens(t),a=new s,i=0;i<n.length;i++){var o=n[i];if(u(o,"tag-open")){if(a.end.column=a.start.column+o.value.length,a.closing=u(o,"end-tag-open"),o=n[++i],!o)return null;for(a.tagName=o.value,a.end.column+=o.value.length,i++;i<n.length;i++)if(o=n[i],a.end.column+=o.value.length,u(o,"tag-close")){a.selfClosing="/>"==o.value;break}return a}if(u(o,"tag-close"))return a.selfClosing="/>"==o.value,a;a.start.column+=o.value.length}return null},this._findEndTagInLine=function(e,t,n,a){for(var i=e.getTokens(t),o=0,r=0;r<i.length;r++){var l=i[r];if(o+=l.value.length,!(o<a)&&u(l,"end-tag-open")&&(l=i[r+1],l&&l.value==n))return!0}return!1},this._readTagForward=function(e){var t=e.getCurrentToken();if(!t)return null;var n=new s;do{if(u(t,"tag-open"))n.closing=u(t,"end-tag-open"),n.start.row=e.getCurrentTokenRow(),n.start.column=e.getCurrentTokenColumn();else if(u(t,"tag-name"))n.tagName=t.value;else if(u(t,"tag-close"))return n.selfClosing="/>"==t.value,n.end.row=e.getCurrentTokenRow(),n.end.column=e.getCurrentTokenColumn()+t.value.length,e.stepForward(),n}while(t=e.stepForward());return null},this._readTagBackward=function(e){var t=e.getCurrentToken();if(!t)return null;var n=new s;do{if(u(t,"tag-open"))return n.closing=u(t,"end-tag-open"),n.start.row=e.getCurrentTokenRow(),n.start.column=e.getCurrentTokenColumn(),e.stepBackward(),n;u(t,"tag-name")?n.tagName=t.value:u(t,"tag-close")&&(n.selfClosing="/>"==t.value,n.end.row=e.getCurrentTokenRow(),n.end.column=e.getCurrentTokenColumn()+t.value.length)}while(t=e.stepBackward());return null},this._pop=function(e,t){while(e.length){var n=e[e.length-1];if(t&&n.tagName!=t.tagName){if(this.optionalEndTags.hasOwnProperty(n.tagName)){e.pop();continue}return null}return e.pop()}},this.getFoldWidgetRange=function(e,t,n){var a=this._getFirstTagInLine(e,n);if(!a)return this.getCommentFoldWidget(e,n)&&e.getCommentFoldRange(n,e.getLine(n).length);var o,l=a.closing||a.selfClosing,s=[];if(l){c=new r(e,n,a.end.column);var u={row:n,column:a.start.column};while(o=this._readTagBackward(c)){if(o.selfClosing){if(s.length)continue;return o.start.column+=o.tagName.length+2,o.end.column-=2,i.fromPoints(o.start,o.end)}if(o.closing)s.push(o);else if(this._pop(s,o),0==s.length)return o.start.column+=o.tagName.length+2,o.start.row==o.end.row&&o.start.column<o.end.column&&(o.start.column=o.end.column),i.fromPoints(o.start,u)}}else{var c=new r(e,n,a.start.column),d={row:n,column:a.start.column+a.tagName.length+2};a.start.row==a.end.row&&(d.column=a.end.column);while(o=this._readTagForward(c)){if(o.selfClosing){if(s.length)continue;return o.start.column+=o.tagName.length+2,o.end.column-=2,i.fromPoints(o.start,o.end)}if(o.closing){if(this._pop(s,o),0==s.length)return i.fromPoints(d,o.start)}else s.push(o)}}}}).call(l.prototype)})),ace.define("ace/mode/xml",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text","ace/mode/xml_highlight_rules","ace/mode/behaviour/xml","ace/mode/folding/xml","ace/worker/worker_client"],(function(e,t,a){"use strict";var i=e("../lib/oop"),o=e("../lib/lang"),r=e("./text").Mode,l=e("./xml_highlight_rules").XmlHighlightRules,s=e("./behaviour/xml").XmlBehaviour,u=e("./folding/xml").FoldMode,c=e("../worker/worker_client").WorkerClient,d=function(){this.HighlightRules=l,this.$behaviour=new s,this.foldingRules=new u};i.inherits(d,r),function(){this.voidElements=o.arrayToMap([]),this.blockComment={start:"\x3c!--",end:"--\x3e"},this.createWorker=function(e){var t=new c(["ace"],n("275b"),"Worker");return t.attachToDocument(e.getDocument()),t.on("error",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t},this.$id="ace/mode/xml"}.call(d.prototype),t.Mode=d}))},4903:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return l})),n.d(t,"l",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return b}));var a=n("9bd2"),i="/jenkins/tpl";function o(e){return Object(a["a"])({url:i+"/page/query",method:"post",data:e})}function r(e){return Object(a["a"])({url:i+"/add",method:"post",data:e})}function l(e){return Object(a["a"])({url:i+"/update",method:"put",data:e})}function s(e){return Object(a["a"])({url:i+"/write",method:"put",data:e})}function u(e){return Object(a["a"])({url:i+"/del?id="+e,method:"delete"})}function c(e){return Object(a["a"])({url:i+"/instance/query?instanceId="+e,method:"get"})}function d(e){return Object(a["a"])({url:i+"/read?id="+e,method:"get"})}function p(e){return Object(a["a"])({url:i+"/ci/job/page/query",method:"post",data:e})}function g(e){return Object(a["a"])({url:i+"/cd/job/page/query",method:"post",data:e})}function m(e){return Object(a["a"])({url:i+"/ci/job/upgrade?jobId="+e,method:"get"})}function f(e){return Object(a["a"])({url:i+"/cd/job/upgrade?jobId="+e,method:"get"})}function b(e){return Object(a["a"])({url:i+"/job/upgrade?tplId="+e,method:"get"})}},6978:function(e,t,n){},"7cc2":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("d2-container",[[n("div",[n("h1",[e._v(e._s(e.title))])]),n("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:24}},[n("el-input",{staticClass:"input",attrs:{placeholder:"输入关键字模糊查询"},model:{value:e.queryParam.queryName,callback:function(t){e.$set(e.queryParam,"queryName",t)},expression:"queryParam.queryName"}}),n("el-button",{staticStyle:{"margin-left":"5px"},on:{click:e.fetchData}},[e._v("查询")]),n("el-button",{staticStyle:{"margin-left":"5px"},on:{click:e.handlerAdd}},[e._v("新增")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{prop:"name",label:"名称"}}),n("el-table-column",{attrs:{prop:"tplName",label:"模版名称"}}),n("el-table-column",{attrs:{prop:"tplType",label:"模版类型",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{"disable-transitions":"",type:"primary",plain:"",size:"mini"}},[e._v(e._s(t.row.tplType))])]}}])}),n("el-table-column",{attrs:{prop:"tplVersion",label:"模版版本"}}),n("el-table-column",{attrs:{prop:"comment",label:"描述"}}),n("el-table-column",{attrs:{prop:"tags",label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"tag-group"},e._l(t.row.tags,(function(t){return n("span",{key:t.id},[n("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:t.comment,placement:"top-start"}},[n("el-tag",{staticStyle:{"margin-left":"5px"},style:{color:t.color}},[e._v(e._s(t.tagKey))])],1)],1)})),0)]}}])}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(n){return e.handlerRowTagEdit(t.row)}}},[e._v("标签")]),n("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(n){return e.handlerRowEdit(t.row)}}},[e._v("编辑")]),n("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(n){return e.handlerRowDel(t.row)}}},[e._v("删除")])]}}])})],1),n("el-pagination",{attrs:{background:"","page-sizes":[10,15,20,25,30],layout:"sizes, prev, pager, next",total:e.pagination.total,"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize},on:{"current-change":e.paginationCurrentChange,"size-change":e.handleSizeChange}}),n("TagTransferDialog",{ref:"tagTransferDialog",attrs:{formStatus:e.formTagTransferStatus},on:{closeDialog:e.fetchData}}),n("JobTplDialog",{ref:"jobTplDialog",attrs:{formStatus:e.formStatus},on:{closeDialog:e.fetchData}})]],2)},i=[],o=(n("a4d3"),n("4de4"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("ade3")),r=n("5880"),l=n("04b5"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.formStatus.operationType?e.formStatus.addTitle:e.formStatus.updateTitle,visible:e.formStatus.visible,width:"80%"},on:{"update:visible":function(t){return e.$set(e.formStatus,"visible",t)}}},[n("el-form",{attrs:{model:e.jobTpl}},[n("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"模版配置",name:"template"}},[n("el-form-item",{attrs:{label:"jenkins实例","label-width":e.labelWidth,required:""}},[n("el-select",{attrs:{filterable:"",clearable:"",disabled:""!==e.jobTpl.id,remote:"","reserve-keyword":"",placeholder:"输入关键词搜索","remote-method":e.getJenkinsInstance,loading:e.instanceLoading},on:{change:e.handlerSelInstance},model:{value:e.jobTpl.jenkinsInstanceId,callback:function(t){e.$set(e.jobTpl,"jenkinsInstanceId","string"===typeof t?t.trim():t)},expression:"jobTpl.jenkinsInstanceId"}},e._l(e.instanceOptions,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[n("span",{staticStyle:{float:"left","margin-right":"15px"}},[e._v(e._s(t.name))]),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.privateIp))])])})),1)],1),""===e.jobTpl.id?n("el-form-item",{attrs:{label:"选择模版","label-width":e.labelWidth,required:""}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tplLoading,expression:"tplLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tplOptions}},[n("el-table-column",{attrs:{prop:"name",label:"模版名称"}}),n("el-table-column",{attrs:{prop:"url",label:"url"}}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(n){return e.handlerRowSelTpl(t.row)}}},[e._v("选择")])]}}],null,!1,183447740)})],1)],1):e._e(),n("el-form-item",{attrs:{label:"名称","label-width":e.labelWidth,required:""}},[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.jobTpl.name,callback:function(t){e.$set(e.jobTpl,"name",t)},expression:"jobTpl.name"}})],1),n("el-form-item",{attrs:{label:"模版名称","label-width":e.labelWidth,required:""}},[n("el-input",{attrs:{disabled:""},model:{value:e.jobTpl.tplName,callback:function(t){e.$set(e.jobTpl,"tplName",t)},expression:"jobTpl.tplName"}})],1),n("el-form-item",{attrs:{label:"模版类型","label-width":e.labelWidth,required:""}},[n("el-select",{attrs:{clearable:""},model:{value:e.jobTpl.tplType,callback:function(t){e.$set(e.jobTpl,"tplType","string"===typeof t?t.trim():t)},expression:"jobTpl.tplType"}},e._l(e.tplTypeOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("el-form-item",{attrs:{label:"模版版本","label-width":e.labelWidth}},[n("el-input",{attrs:{disabled:""},model:{value:e.jobTpl.tplVersion,callback:function(t){e.$set(e.jobTpl,"tplVersion",t)},expression:"jobTpl.tplVersion"}})],1),n("el-form-item",{attrs:{label:"发布回滚","label-width":e.labelWidth,required:""}},[n("el-checkbox",{model:{value:e.jobTpl.supportRollback,callback:function(t){e.$set(e.jobTpl,"supportRollback",t)},expression:"jobTpl.supportRollback"}},[e._v("模版支持回滚操作")])],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.jobTpl.supportRollback,expression:"jobTpl.supportRollback"}],attrs:{label:"回滚类型","label-width":e.labelWidth,required:""}},[n("el-select",{attrs:{clearable:""},model:{value:e.jobTpl.rollbackType,callback:function(t){e.$set(e.jobTpl,"rollbackType",t)},expression:"jobTpl.rollbackType"}},e._l(e.rollbackTypeOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("el-form-item",{attrs:{label:"描述","label-width":e.labelWidth}},[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.jobTpl.comment,callback:function(t){e.$set(e.jobTpl,"comment",t)},expression:"jobTpl.comment"}})],1)],1),n("el-tab-pane",{attrs:{label:"模版内容",name:"content",disabled:e.formStatus.operationType}},[n("div",{staticStyle:{width:"100%","text-align":"center","margin-bottom":"5px"}},[n("el-button",{attrs:{align:"center",type:"primary",plain:"",size:"mini"},on:{click:function(t){return e.handlerReadTplContent()}}},[e._v("读取模版")]),n("el-button",{attrs:{align:"center",type:"primary",plain:"",size:"mini"},on:{click:function(t){return e.handlerSaveTplContent()}}},[e._v("写入模版")])],1),n("el-form-item",{attrs:{label:"模版详情","label-width":e.labelWidth,required:""}},[n("editor",{attrs:{lang:"xml",theme:"chrome",width:"100%",height:"500"},on:{init:e.editorInit},model:{value:e.jobTpl.tplContent,callback:function(t){e.$set(e.jobTpl,"tplContent",t)},expression:"jobTpl.tplContent"}})],1)],1),n("el-tab-pane",{attrs:{label:"参数配置",name:"parameter",disabled:e.formStatus.operationType}},[n("el-form-item",{attrs:{label:"模版参数","label-width":e.labelWidth,required:!0}},[n("editor",{attrs:{lang:"yaml",theme:"chrome",width:"100%",height:"400"},on:{init:e.editorInit},model:{value:e.jobTpl.parameterYaml,callback:function(t){e.$set(e.jobTpl,"parameterYaml",t)},expression:"jobTpl.parameterYaml"}})],1)],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(t){e.formStatus.visible=!1}}},[e._v("取消")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handlerSave}},[e._v("确定")])],1)],1)},u=[],c=(n("b0c0"),n("7d80")),d=n("4903"),p=[{value:"iOS",label:"iOS"},{value:"Android",label:"Android"},{value:"H5",label:"H5"},{value:"JAVA",label:"JAVA"},{value:"PYTHON",label:"PYTHON"}],g=[{value:0,label:"Commit回滚"},{value:1,label:"构件回滚"}],m={data:function(){return{activeName:"template",jobTpl:{},labelWidth:"150px",options:{stripe:!0},tplTypeOptions:p,rollbackTypeOptions:g,instanceLoading:!1,instanceOptions:[],tplOptions:[],tplLoading:!1}},name:"JobTplDialog",props:["formStatus"],components:{editor:n("7c9e")},mounted:function(){},methods:{editorInit:function(){n("2099"),n("2968"),n("0696"),n("95b8"),n("ec5e"),n("058d")},closeDialog:function(){this.instanceOptions=[],this.tplOptions=[],this.formStatus.visible=!1,this.$emit("closeDialog")},initData:function(e){this.jobTpl=e,this.activeName="template",""===this.jobTpl.id?this.getJenkinsInstance(""):(this.instanceOptions=[],this.instanceOptions.push(e.jenkinsInstance))},handleClick:function(){this.$emit("input",!this.value)},getJenkinsInstance:function(e){var t=this;this.instanceLoading=!0;var n={queryName:e,extend:1,page:1,length:10};Object(c["c"])(n).then((function(e){t.instanceOptions=e.body.data,t.instanceLoading=!1}))},handlerSelInstance:function(){this.getTpl()},getTpl:function(){var e=this;this.tplLoading=!0,Object(d["e"])(this.jobTpl.jenkinsInstanceId).then((function(t){e.tplOptions=t.body,e.tplLoading=!1}))},handlerReadTplContent:function(){var e=this;Object(d["g"])(this.jobTpl.id).then((function(t){t.success?(e.$message({message:"读取成功！",type:"success"}),e.jobTpl.tplContent=t.body):e.$message.error(t.msg)}))},handlerRowSelTpl:function(e){this.jobTpl.tplName=e.name},handlerSaveTplContent:function(){var e=this;setTimeout((function(){var t=Object.assign({},e.jobTpl);Object(d["l"])(t).then((function(t){t.success?e.$message({message:"成功",type:"success"}):e.$message.error(t.msg)}))}),600)},handlerSave:function(){var e=this;setTimeout((function(){var t=Object.assign({},e.jobTpl);e.formStatus.operationType?Object(d["a"])(t).then((function(t){e.$message({message:"成功",type:"success"}),e.closeDialog()})):Object(d["h"])(t).then((function(t){e.$message({message:"成功",type:"success"}),e.closeDialog()}))}),600)}}},f=m,b=n("2877"),h=function(e){e.options.__source="src/components/opscloud/jenkins/JobTplDialog.vue"},v=h,x=Object(b["a"])(f,s,u,!1,null,null,null);"function"===typeof v&&v(x);var T=x.exports,k=n("a3e9");function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j={name:"JobTplTable",data:function(){return{title:"任务模版管理",tableData:[],options:{stripe:!0},loading:!1,pagination:{currentPage:1,pageSize:10,total:0},queryParam:{instanceId:"",queryName:""},formStatus:{visible:!1,operationType:!0,addTitle:"新增任务模版配置",updateTitle:"更新任务模版配置"},businessType:10,formTagTransferStatus:{visible:!1,title:"编辑任务模版标签"}}},computed:w({},Object(r["mapState"])("d2admin/user",["info"])),mounted:function(){this.initPageSize(),this.fetchData()},components:{TagTransferDialog:l["a"],JobTplDialog:T},methods:w({},Object(r["mapActions"])({setPageSize:"d2admin/user/set"}),{handleSizeChange:function(e){this.pagination.pageSize=e,this.info.pageSize=e,this.setPageSize(this.info),this.fetchData()},initPageSize:function(){"undefined"!==typeof this.info.pageSize&&(this.pagination.pageSize=this.info.pageSize)},handlerAdd:function(){var e={id:"",name:"",jenkinsInstanceId:"",tplName:"",tplType:"",tplVersion:1,tplHash:"",parameterYaml:"",comment:""};this.formStatus.operationType=!0,this.formStatus.visible=!0,this.$refs.jobTplDialog.initData(Object.assign({},e))},handlerRowTagEdit:function(e){this.formTagTransferStatus.visible=!0;var t={businessId:e.id,businessType:this.businessType,tagIds:[],tagOptions:[]};Object(k["d"])("",1,100).then((function(e){t.tagOptions=e.body.data})),Object(k["c"])(this.businessType,t.businessId,"").then((function(e){for(var n in e.body)t.tagIds.push(e.body[n].id)})),this.formTagTransferStatus.visible=!0,this.$refs.tagTransferDialog.initData(t)},handlerRowEdit:function(e){this.formStatus.operationType=!1,this.formStatus.visible=!0,this.$refs.jobTplDialog.initData(Object.assign({},e))},handlerRowDel:function(e){var t=this;this.$confirm("此操作将删除当前配置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["b"])(e.id).then((function(e){t.fetchData(),t.$message({type:"success",message:"删除成功!"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.loading=!0;var t={queryName:this.queryParam.queryName,extend:1,page:this.pagination.currentPage,length:this.pagination.pageSize};Object(d["f"])(t).then((function(t){e.tableData=t.body.data,e.pagination.total=t.body.totalNum,e.loading=!1}))}})},_=j,O=(n("b1f1"),function(e){e.options.__source="src/pages/jenkins/job/template/index.vue"}),S=O,C=Object(b["a"])(_,a,i,!1,null,null,null);"function"===typeof S&&S(C);t["default"]=C.exports},"7d80":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u}));var a=n("9bd2"),i="/jenkins/instance";function o(e){return Object(a["a"])({url:i+"/page/query",method:"post",data:e})}function r(e){return Object(a["a"])({url:i+"/add",method:"post",data:e})}function l(e){return Object(a["a"])({url:i+"/update",method:"put",data:e})}function s(e){return Object(a["a"])({url:i+"/del?id="+e,method:"delete"})}function u(e){return Object(a["a"])({url:i+"/active/set?id="+e,method:"get"})}},a3e9:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return u}));var a=n("9bd2");function i(e,t,n){return Object(a["a"])({url:"/tag/page/query?tagKey="+e+"&page="+t+"&length="+n,method:"get"})}function o(e){return Object(a["a"])({url:"/tag/add",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/tag/del?id="+e,method:"delete"})}function l(e){return Object(a["a"])({url:"/tag/update",method:"put",data:e})}function s(e){return Object(a["a"])({url:"/tag/business/update",method:"put",data:e})}function u(e,t,n){return Object(a["a"])({url:"/tag/business/query?businessType="+e+"&businessId="+t+"&tagKey="+n,method:"get"})}},b1f1:function(e,t,n){"use strict";var a=n("6978"),i=n.n(a);i.a},ec5e:function(e,t){ace.define("ace/snippets/yaml",["require","exports","module"],(function(e,t,n){"use strict";t.snippetText=void 0,t.scope="yaml"}))}}]);